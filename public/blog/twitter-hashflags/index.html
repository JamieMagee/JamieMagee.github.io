<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">


  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Twitter Hashflags (_Hash-what?_) &middot; Jamie Magee</title>


  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/hyde.css">
  <link rel="stylesheet" href="/css/poole-overrides.css">
  <link rel="stylesheet" href="/css/hyde-overrides.css">
  <link rel="stylesheet" href="/css/hyde-x.css">
  <link rel="stylesheet" href="/css/highlight/github.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/jamie.css">


  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link href="/favicon.ico" rel="icon">






  <meta name="description" content="">
  <meta name="keywords" content="">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-701081-9', 'auto');

	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body class="theme-base-0c">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <div class="sidebar-head">

        <img src="https://www.gravatar.com/avatar/5a37e2531db08529192d7d323e8cecd8?s=200"
             alt="gravatar" title="Jamie Magee">

      <h1><a href="/">Jamie Magee</a></h1>
      </div>
      <p class="lead">Programmer, Engineer, Problem Solver</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="/">Home</a></li>

      <li class="sidebar-nav-item "><a href="/about">About</a></li>

      <li class="sidebar-nav-item "><a href="/blog">Archive</a></li>

    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/JamieMagee"><i class="fa fa-github-square fa-3x"></i></a>


      <a href="https://www.linkedin.com/in/jamiemagee1/"><i class="fa fa-linkedin-square fa-3x"></i></a>


      <a href="http://twitter.com/Jamie_Magee"><i class="fa fa-twitter-square fa-3x"></i></a>


      </li>
    </ul>



    <p>
  &copy; 2019. <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a>
</p>

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">Twitter Hashflags (<em>Hash-what?</em>)</h1>
    <span class="post-date">Mar 28, 2018 &middot; 4 minute read &middot; <a href="/blog/twitter-hashflags/#disqus_thread">Comments</a>
    </span>
    <p>Have you ever tweeted out a hastag, and discovered a small image attached to the side of it? It could be for <a href="https://twitter.com/HashflagArchive/status/972005822388514818">#StPatricksDay</a>, <a href="https://twitter.com/HashflagArchive/status/972170656912723969">#MarchForOurLives</a>, or whatever <a href="https://twitter.com/HashflagArchive/status/960529700442566656">#白白白白白白白白白白</a> is meant to be. These are hashflags.</p>

<p>A hashflag, sometimes called Twitter emoji, is a small image that appears after a #hashtag for special events. They are not regular emoji, and you can only use them on the Twitter website, or the official Twitter apps. For example:</p>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/MondayMotivation?src=hash&amp;ref_src=twsrc%5Etfw">#MondayMotivation</a>: <a href="https://twitter.com/hashtag/CNY?src=hash&amp;ref_src=twsrc%5Etfw">#CNY</a> celebrations are like a marathon not a sprint. Keep up the festive momentum and celebrate with the <a href="https://twitter.com/hashtag/CNY?src=hash&amp;ref_src=twsrc%5Etfw">#CNY</a> emoji using the below hashtags from now until Mar 2nd. <a href="https://twitter.com/hashtag/YearOfTheDog?src=hash&amp;ref_src=twsrc%5Etfw">#YearOfTheDog</a> <a href="https://twitter.com/hashtag/LunarNewYear?src=hash&amp;ref_src=twsrc%5Etfw">#LunarNewYear</a> <a href="https://twitter.com/hashtag/GongXiFaCai?src=hash&amp;ref_src=twsrc%5Etfw">#GongXiFaCai</a> <a href="https://twitter.com/hashtag/%E7%8B%97%E5%B9%B4%E6%97%BA%E6%97%BA?src=hash&amp;ref_src=twsrc%5Etfw">#狗年旺旺</a><a href="https://twitter.com/hashtag/%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90?src=hash&amp;ref_src=twsrc%5Etfw">#新年快乐</a><a href="https://twitter.com/hashtag/%E6%81%AD%E5%96%9C%E5%8F%91%E8%B4%A2?src=hash&amp;ref_src=twsrc%5Etfw">#恭喜发财</a><br><br>Happy Monday! <a href="https://t.co/DHAfxnEcSo">pic.twitter.com/DHAfxnEcSo</a></p>&mdash; Twitter Singapore (@TwitterSG) <a href="https://twitter.com/TwitterSG/status/965399443733278720?ref_src=twsrc%5Etfw">February 19, 2018</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>If you&rsquo;re a company, and <a href="http://www.adweek.com/digital/twitters-branded-emojis-come-million-dollar-commitment-169327/">you have enough money</a>, you can buy your own hashflag as well! That&rsquo;s exactly what Disney did for the release of Star Wars: The Last Jedi.</p>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">New hashtag emojis released by <a href="https://twitter.com/Twitter?ref_src=twsrc%5Etfw">@Twitter</a> and <a href="https://twitter.com/starwars?ref_src=twsrc%5Etfw">@StarWars</a> ahead of <a href="https://twitter.com/hashtag/TheLastJedi?src=hash&amp;ref_src=twsrc%5Etfw">#TheLastJedi</a>! <a href="https://twitter.com/hashtag/BB8?src=hash&amp;ref_src=twsrc%5Etfw">#BB8</a> <a href="https://twitter.com/hashtag/BB9E?src=hash&amp;ref_src=twsrc%5Etfw">#BB9E</a> <a href="https://twitter.com/hashtag/Porg?src=hash&amp;ref_src=twsrc%5Etfw">#Porg</a> <a href="https://t.co/nnRJf43o0V">pic.twitter.com/nnRJf43o0V</a></p>&mdash; Good Morning America (@GMA) <a href="https://twitter.com/GMA/status/935573161051152385?ref_src=twsrc%5Etfw">November 28, 2017</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>If you spend the money to buy a hashflag, it&rsquo;s important that you launch it correctly—otherwise they can flop. <a href="https://twitter.com/HashflagArchive/status/960529700442566656">#白白白白白白白白白白</a> is an example of what not to do. At time of writing, it has only 10 uses.</p>

<p>Hashflags aren&rsquo;t exclusive to English, and they can help add context to a tweet in another language. I don&rsquo;t speak any Russian, but I do know that this image is of BB-8!</p>

<blockquote class="twitter-tweet"><p lang="und" dir="ltr"><a href="https://twitter.com/hashtag/%D0%B7%D0%B2%D1%91%D0%B7%D0%B4%D0%BD%D1%8B%D0%B5%D0%B2%D0%BE%D0%B9%D0%BD%D1%8B%D1%8D%D0%BF%D0%B8%D0%B7%D0%BE%D0%B48?src=hash&amp;ref_src=twsrc%5Etfw">#звёздныевойныэпизод8</a> <a href="https://t.co/qZsjHFR4jk">pic.twitter.com/qZsjHFR4jk</a></p>&mdash; Hashflags (@HashflagArchive) <a href="https://twitter.com/HashflagArchive/status/956184319206273024?ref_src=twsrc%5Etfw">January 24, 2018</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>Unfortunately hashflags are temporary, so any context they add to a tweet can sometimes be lost at a later date. Currently Twitter doesn&rsquo;t provide an official API for hashflags, and there is no canonical list of currently active hashflags. <a href="https://twitter.com/hashflaglist">@hashflaglist</a> tracks hashflags, but it&rsquo;s easy to miss one—this is where Azure Functions come in.</p>

<p>It turns out that on <a href="https://twitter.com">Twitter.com</a> the list of currently active hashflags is sent as a JSON object in the HTML as initial data. All I need to do is fetch Twitter.com, and extract the JSON object from the HTML.</p>

<pre><code class="language-bash">$ curl https://twitter.com -v --silent 2&gt;&amp;1 | grep -o -P '.{6}activeHashflags.{6}'

&amp;quot;activeHashflags&amp;quot;
</code></pre>

<p>I wrote <a href="https://github.com/JamieMagee/hashflags-function/blob/master/hashflags/ActiveHashflags.cs">some C#</a> to parse and extract the <code>activeHashflags</code> JSON object, and store it in an Azure blob. You can find it <a href="https://hashflags.blob.core.windows.net/json/activeHashflags">here</a>. Using Azure Functions I can run this code on a timer, so the Azure blob is always up to date with the latest Twitter hashflags. This means the blob can be used as an unofficial Twitter hashflags API—but I didn&rsquo;t want to stop there.</p>

<p>I wanted to solve some of the issues with hashflags around both discovery and durability. Azure Functions is the perfect platform for these small, single purpose pieces of code. I ended up writing five Azure Functions in total—all of which can be found <a href="https://github.com/JamieMagee/hashflags-function">on GitHub</a>.</p>

<p><a href="https://github.com/JamieMagee/hashflags-function"><img src="/img/hashflags-function-github.png" alt="Screenshot of hashflags-function GitHub page" /></a></p>

<ol>
<li><code>ActiveHashflags</code> fetches the active hashflags from Twitter, and stores them in a JSON object in an Azure Storage Blob. You can find the list of current hashflags <a href="https://hashflags.blob.core.windows.net/json/activeHashflags">here</a>.</li>
<li><code>UpdateHashflagState</code> reads the JSON, and updates the hashflag table with the current state of each hashflag.</li>
<li><code>StoreHashflagImage</code> downloads the hashflag image, and stores it in a blob store.</li>
<li><code>CreateHeroImage</code> creates a hero image of the hashtag and hashflag.</li>
<li><code>TweetHashflag</code> tweets the hashtag and hero image.</li>
</ol>

<p>Say hello to <a href="https://twitter.com/HashflagArchive">@HashflagArchive</a>!</p>

<p><a href="https://twitter.com/HashflagArchive"><img src="/img/hashflag-archive.png" alt="Screenshot of HashflagArchive Twitter stream" /></a></p>

<p>@HashflagArchive solves both the issues I have with hashflags: it tweets out new hashflags the same hour they are activated on twitter, which solves the issue of discovery; and it tweets an image of the hashtag and hashflag, which solves the issue of hashflags being temporary.</p>

<p>So this is great, but there&rsquo;s still one issue—how to use hashflags outside of Twitter.com and the official Twitter apps. This is where the JSON blob comes in. I can build a wrapper library around that, and then using that library, build applications with Twitter hashflags. So that&rsquo;s exactly what I did.</p>

<p><a href="https://github.com/JamieMagee/hashflags-node"><img src="/img/hashflags-node-github.png" alt="Screenshot of hashflags-node GitHub page" /></a></p>

<p>I wrote an npm package called <a href="https://www.npmjs.com/package/hashflags"><code>hashflags</code></a>. It&rsquo;s pretty simple to use, and integrates nicely with the official <a href="https://www.npmjs.com/package/twitter-text"><code>twitter-text</code> </a> npm package.</p>

<pre><code class="language-ts">import { Hashflags } from 'hashflags';

let hf: Hashflags;
Hashflags.FETCH().then((val: Map&lt;string, string&gt;) =&gt; {
  hf = new Hashflags(val);
  console.log(hf.activeHashflags);
});
</code></pre>

<p>I wrote it in TypeScript, but it can also be used from plain old JS as well.</p>

<pre><code class="language-js">const Hashflags = require('hashflags').Hashflags;

let hf;
Hashflags.FETCH().then(val =&gt; {
  hf = new Hashflags(val);
  console.log(hf.activeHashflags);
});
</code></pre>

<p>So there you have it, a quick introduction to Twitter hashflags via Azure Functions and an npm library. If you&rsquo;ve got any questions please leave a comment below, or reach out to me on Twitter <a href="https://twitter.com/Jamie_Magee">@Jamie_Magee</a>.</p>

  </div>
  <div id="disqus_thread"></div>
</div>


<script type="text/javascript">
var disqus_shortname = "jamiemagee";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



<script type="text/javascript">
    var disqus_shortname = "jamiemagee";
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="/js/cms.js"></script>
</body>
</html>
